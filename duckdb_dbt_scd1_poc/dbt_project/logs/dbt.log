[0m14:06:05.063047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150BD36480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150AEA7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150E613860>]}


============================== 14:06:05.066046 | 79022602-9a29-4b0b-ab92-66b1ab074c54 ==============================
[0m14:06:05.066046 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:06:05.067047 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\thesy\\.dbt'}
[0m14:06:05.078722 [info ] [MainThread]: dbt version: 1.10.10
[0m14:06:05.079722 [info ] [MainThread]: python version: 3.12.9
[0m14:06:05.079722 [info ] [MainThread]: python path: C:\Users\thesy\.conda\envs\TheAlamo\python.exe
[0m14:06:05.079722 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m14:06:05.079722 [info ] [MainThread]: Using profiles dir at C:\Users\thesy\.dbt
[0m14:06:05.080722 [info ] [MainThread]: Using profiles.yml file at C:\Users\thesy\.dbt\profiles.yml
[0m14:06:05.080722 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\dbt_project.yml
[0m14:06:05.166604 [info ] [MainThread]: Configuration:
[0m14:06:05.167601 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m14:06:05.167601 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:06:05.167601 [info ] [MainThread]: Required dependencies:
[0m14:06:05.168661 [debug] [MainThread]: Executing "git --help"
[0m14:06:05.190744 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:06:05.190744 [debug] [MainThread]: STDERR: "b''"
[0m14:06:05.191746 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:06:05.191746 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:06:05.191746 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:06:05.192745 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\thesy\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m14:06:05.192745 [debug] [MainThread]: Command `dbt debug` failed at 14:06:05.192745 after 0.20 seconds
[0m14:06:05.193744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150EB7D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150E613860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215102C3CB0>]}
[0m14:06:05.193744 [debug] [MainThread]: Flushing usage events
[0m14:06:05.362190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:42.979527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C824279E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C827DB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C83F10E90>]}


============================== 14:07:42.982637 | 8c1c4552-e472-45be-99b5-f06a450d6d52 ==============================
[0m14:07:42.982637 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:07:42.983642 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:07:42.994641 [info ] [MainThread]: dbt version: 1.10.10
[0m14:07:42.995641 [info ] [MainThread]: python version: 3.12.9
[0m14:07:42.995641 [info ] [MainThread]: python path: C:\Users\thesy\.conda\envs\TheAlamo\python.exe
[0m14:07:42.996209 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m14:07:43.063027 [info ] [MainThread]: Using profiles dir at C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project
[0m14:07:43.064027 [info ] [MainThread]: Using profiles.yml file at C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\profiles.yml
[0m14:07:43.064027 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\dbt_project.yml
[0m14:07:43.066028 [info ] [MainThread]: adapter type: duckdb
[0m14:07:43.066028 [info ] [MainThread]: adapter version: 1.9.4
[0m14:07:43.149377 [info ] [MainThread]: Configuration:
[0m14:07:43.149377 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:07:43.149377 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:07:43.149377 [info ] [MainThread]: Required dependencies:
[0m14:07:43.149377 [debug] [MainThread]: Executing "git --help"
[0m14:07:43.176318 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:07:43.176318 [debug] [MainThread]: STDERR: "b''"
[0m14:07:43.177318 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:07:43.177318 [info ] [MainThread]: Connection:
[0m14:07:43.177318 [info ] [MainThread]:   database: duck_poc
[0m14:07:43.178317 [info ] [MainThread]:   schema: main
[0m14:07:43.178317 [info ] [MainThread]:   path: duck_poc.duckdb
[0m14:07:43.178317 [info ] [MainThread]:   config_options: None
[0m14:07:43.178317 [info ] [MainThread]:   extensions: None
[0m14:07:43.179318 [info ] [MainThread]:   settings: {}
[0m14:07:43.179318 [info ] [MainThread]:   external_root: .
[0m14:07:43.179318 [info ] [MainThread]:   use_credential_provider: None
[0m14:07:43.179318 [info ] [MainThread]:   attach: None
[0m14:07:43.179318 [info ] [MainThread]:   filesystems: None
[0m14:07:43.180317 [info ] [MainThread]:   remote: None
[0m14:07:43.180317 [info ] [MainThread]:   plugins: None
[0m14:07:43.180317 [info ] [MainThread]:   disable_transactions: False
[0m14:07:43.180317 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:07:43.331034 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:07:44.729609 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:07:44.729609 [debug] [MainThread]: On debug: select 1 as id
[0m14:07:44.729609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:44.744800 [debug] [MainThread]: SQL status: OK in 0.012 seconds
[0m14:07:44.745793 [debug] [MainThread]: On debug: Close
[0m14:07:44.745793 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:07:44.745793 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:07:44.745793 [debug] [MainThread]: Command `dbt debug` succeeded at 14:07:44.745793 after 1.85 seconds
[0m14:07:44.745793 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:07:44.745793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C82B91100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C8439E390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C84411010>]}
[0m14:07:44.745793 [debug] [MainThread]: Flushing usage events
[0m14:07:44.882678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:18.536361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64A8F3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64D719040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64D71ACF0>]}


============================== 14:08:18.539362 | 77c704d6-dbc3-42d6-b824-70153316e3fe ==============================
[0m14:08:18.539362 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:08:18.540362 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m14:08:18.817905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64D0E88F0>]}
[0m14:08:18.871090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64EFA59A0>]}
[0m14:08:18.873812 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:08:19.017848 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m14:08:19.017848 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:08:19.018849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64EFA51F0>]}
[0m14:08:20.307523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64F828CE0>]}
[0m14:08:20.353118 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\manifest.json
[0m14:08:20.364828 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\semantic_manifest.json
[0m14:08:20.380079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64F87A360>]}
[0m14:08:20.381079 [info ] [MainThread]: Found 5 models, 15 data tests, 429 macros
[0m14:08:20.381079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64F8E7350>]}
[0m14:08:20.383079 [info ] [MainThread]: 
[0m14:08:20.383079 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:08:20.383079 [info ] [MainThread]: 
[0m14:08:20.384079 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:08:20.387078 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duck_poc'
[0m14:08:20.432736 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc"
[0m14:08:20.432736 [debug] [ThreadPool]: On list_duck_poc: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "list_duck_poc"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duck_poc"'
    
  
  
[0m14:08:20.432736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:20.448633 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m14:08:20.449891 [debug] [ThreadPool]: On list_duck_poc: Close
[0m14:08:20.450890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duck_poc, now create_duck_poc_main)
[0m14:08:20.450890 [debug] [ThreadPool]: Creating schema "database: "duck_poc"
schema: "main"
"
[0m14:08:20.455890 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:08:20.455890 [debug] [ThreadPool]: On create_duck_poc_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "create_duck_poc_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duck_poc'
        and type='sqlite'
    
  
[0m14:08:20.455890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:20.456890 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:20.457892 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:08:20.457892 [debug] [ThreadPool]: On create_duck_poc_main: BEGIN
[0m14:08:20.457892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:08:20.458891 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:08:20.458891 [debug] [ThreadPool]: On create_duck_poc_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "create_duck_poc_main"} */

    
    
        create schema if not exists "duck_poc"."main"
    
[0m14:08:20.458891 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:08:20.459891 [debug] [ThreadPool]: On create_duck_poc_main: COMMIT
[0m14:08:20.459891 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:08:20.459891 [debug] [ThreadPool]: On create_duck_poc_main: COMMIT
[0m14:08:20.459891 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:08:20.459891 [debug] [ThreadPool]: On create_duck_poc_main: Close
[0m14:08:20.460891 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duck_poc_main'
[0m14:08:20.464889 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc_main"
[0m14:08:20.464889 [debug] [ThreadPool]: On list_duck_poc_main: BEGIN
[0m14:08:20.465659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:20.465659 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:08:20.465659 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc_main"
[0m14:08:20.466314 [debug] [ThreadPool]: On list_duck_poc_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "list_duck_poc_main"} */
select
      'duck_poc' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duck_poc'
  
[0m14:08:20.472317 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m14:08:20.473811 [debug] [ThreadPool]: On list_duck_poc_main: ROLLBACK
[0m14:08:20.474115 [debug] [ThreadPool]: Failed to rollback 'list_duck_poc_main'
[0m14:08:20.474115 [debug] [ThreadPool]: On list_duck_poc_main: Close
[0m14:08:20.475176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64F9004A0>]}
[0m14:08:20.475176 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:20.475176 [debug] [MainThread]: On master: BEGIN
[0m14:08:20.475176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:20.476177 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:20.476177 [debug] [MainThread]: On master: COMMIT
[0m14:08:20.476177 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:20.476177 [debug] [MainThread]: On master: COMMIT
[0m14:08:20.477177 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:20.477177 [debug] [MainThread]: On master: Close
[0m14:08:20.479782 [debug] [Thread-1 (]: Began running node model.duckdb_poc.customers_d1
[0m14:08:20.479782 [debug] [Thread-2 (]: Began running node model.duckdb_poc.sales_d1
[0m14:08:20.480782 [info ] [Thread-1 (]: 1 of 5 START sql table model main.customers_d1 ................................. [RUN]
[0m14:08:20.480782 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.duckdb_poc.customers_d1'
[0m14:08:20.481783 [debug] [Thread-1 (]: Began compiling node model.duckdb_poc.customers_d1
[0m14:08:20.480782 [info ] [Thread-2 (]: 2 of 5 START sql table model main.sales_d1 ..................................... [RUN]
[0m14:08:20.486322 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_poc.customers_d1"
[0m14:08:20.486322 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.duckdb_poc.sales_d1'
[0m14:08:20.486322 [debug] [Thread-2 (]: Began compiling node model.duckdb_poc.sales_d1
[0m14:08:20.488328 [debug] [Thread-2 (]: Writing injected SQL for node "model.duckdb_poc.sales_d1"
[0m14:08:20.490339 [debug] [Thread-2 (]: Began executing node model.duckdb_poc.sales_d1
[0m14:08:20.505714 [debug] [Thread-1 (]: Began executing node model.duckdb_poc.customers_d1
[0m14:08:20.511706 [debug] [Thread-2 (]: Writing runtime sql for node "model.duckdb_poc.sales_d1"
[0m14:08:20.513707 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_poc.customers_d1"
[0m14:08:20.514424 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:08:20.515450 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: BEGIN
[0m14:08:20.515450 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:08:20.516449 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:08:20.516449 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: BEGIN
[0m14:08:20.516449 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.516449 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:20.517467 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:08:20.517467 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */

  
    
    

    create  table
      "duck_poc"."main"."sales_d1__dbt_tmp"
  
    as (
      
-- Treat CSVs under /data as your D0 snapshots
select
  cast(sales_id as integer) as sales_id,
  customer_id,
  cast(amount as double) as amount,
  currency_code,
  cast(event_ts as timestamp) as event_ts,
  cast(load_hour as timestamp) as load_hour
from read_csv_auto('../data/sales_2025-08-31-10.csv', header=True)
    );
  
  
[0m14:08:20.517467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.517467 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:08:20.518448 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */

  
    
    

    create  table
      "duck_poc"."main"."customers_d1__dbt_tmp"
  
    as (
      
select
  customer_id,
  upper(trim(customer_name)) as customer_name,
  email,
  region_code,
  cast(load_hour as timestamp) as load_hour
from read_csv_auto('../data/customers_2025-08-31-10.csv', header=True)
    );
  
  
[0m14:08:20.522448 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:08:20.527455 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:08:20.527455 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m14:08:20.527455 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */
alter table "duck_poc"."main"."customers_d1__dbt_tmp" rename to "customers_d1"
[0m14:08:20.529447 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:08:20.529447 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */
alter table "duck_poc"."main"."sales_d1__dbt_tmp" rename to "sales_d1"
[0m14:08:20.530448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:08:20.537455 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m14:08:20.538950 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: COMMIT
[0m14:08:20.539952 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: COMMIT
[0m14:08:20.539952 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:08:20.539952 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:08:20.540953 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: COMMIT
[0m14:08:20.540953 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: COMMIT
[0m14:08:20.542954 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:20.546959 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:08:20.546959 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */

      drop table if exists "duck_poc"."main"."customers_d1__dbt_backup" cascade
    
[0m14:08:20.546959 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:08:20.548771 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:08:20.548771 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */

      drop table if exists "duck_poc"."main"."sales_d1__dbt_backup" cascade
    
[0m14:08:20.549814 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:08:20.550963 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: Close
[0m14:08:20.550963 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:08:20.552971 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: Close
[0m14:08:20.552971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64F7F9C10>]}
[0m14:08:20.553970 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64FD89D60>]}
[0m14:08:20.553970 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.customers_d1 ............................ [[32mOK[0m in 0.07s]
[0m14:08:20.554964 [debug] [Thread-1 (]: Finished running node model.duckdb_poc.customers_d1
[0m14:08:20.553970 [info ] [Thread-2 (]: 2 of 5 OK created sql table model main.sales_d1 ................................ [[32mOK[0m in 0.07s]
[0m14:08:20.554964 [debug] [Thread-2 (]: Finished running node model.duckdb_poc.sales_d1
[0m14:08:20.555963 [debug] [Thread-4 (]: Began running node model.duckdb_poc.dim_customer
[0m14:08:20.555963 [debug] [Thread-1 (]: Began running node model.duckdb_poc.fct_sales
[0m14:08:20.555963 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_customer ................................. [RUN]
[0m14:08:20.556964 [info ] [Thread-1 (]: 4 of 5 START sql table model main.fct_sales .................................... [RUN]
[0m14:08:20.556964 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.duckdb_poc.dim_customer'
[0m14:08:20.556964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_poc.customers_d1, now model.duckdb_poc.fct_sales)
[0m14:08:20.556964 [debug] [Thread-4 (]: Began compiling node model.duckdb_poc.dim_customer
[0m14:08:20.556964 [debug] [Thread-1 (]: Began compiling node model.duckdb_poc.fct_sales
[0m14:08:20.559264 [debug] [Thread-4 (]: Writing injected SQL for node "model.duckdb_poc.dim_customer"
[0m14:08:20.561263 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_poc.fct_sales"
[0m14:08:20.562256 [debug] [Thread-4 (]: Began executing node model.duckdb_poc.dim_customer
[0m14:08:20.564256 [debug] [Thread-4 (]: Writing runtime sql for node "model.duckdb_poc.dim_customer"
[0m14:08:20.564256 [debug] [Thread-1 (]: Began executing node model.duckdb_poc.fct_sales
[0m14:08:20.566647 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_poc.fct_sales"
[0m14:08:20.567647 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:08:20.567647 [debug] [Thread-1 (]: On model.duckdb_poc.fct_sales: BEGIN
[0m14:08:20.567647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:20.567647 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:08:20.568648 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: BEGIN
[0m14:08:20.568648 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:08:20.568648 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.569647 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:08:20.569647 [debug] [Thread-1 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */

  
    
    

    create  table
      "duck_poc"."main"."fct_sales__dbt_tmp"
  
    as (
      
select
  sales_id,
  event_ts as sale_ts,
  amount,
  currency_code,
  customer_id
from "duck_poc"."main"."sales_d1"
    );
  
  
[0m14:08:20.569647 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.569647 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:08:20.570646 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */

  
    
    

    create  table
      "duck_poc"."main"."dim_customer__dbt_tmp"
  
    as (
      
select
  customer_id,
  any_value(customer_name) as customer_name,
  any_value(email) as email,
  any_value(region_code) as region_code
from "duck_poc"."main"."customers_d1"
group by customer_id
    );
  
  
[0m14:08:20.570646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.573646 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:08:20.573646 [debug] [Thread-1 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */
alter table "duck_poc"."main"."fct_sales__dbt_tmp" rename to "fct_sales"
[0m14:08:20.573646 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:08:20.575847 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:08:20.575847 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:08:20.576854 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */
alter table "duck_poc"."main"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m14:08:20.577847 [debug] [Thread-1 (]: On model.duckdb_poc.fct_sales: COMMIT
[0m14:08:20.577847 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:08:20.577847 [debug] [Thread-1 (]: On model.duckdb_poc.fct_sales: COMMIT
[0m14:08:20.578849 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.579848 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: COMMIT
[0m14:08:20.579848 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:08:20.579848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.579848 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: COMMIT
[0m14:08:20.581848 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:08:20.581848 [debug] [Thread-1 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */

      drop table if exists "duck_poc"."main"."fct_sales__dbt_backup" cascade
    
[0m14:08:20.582849 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.584848 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:08:20.584848 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:08:20.585848 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */

      drop table if exists "duck_poc"."main"."dim_customer__dbt_backup" cascade
    
[0m14:08:20.585848 [debug] [Thread-1 (]: On model.duckdb_poc.fct_sales: Close
[0m14:08:20.586849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64FD889E0>]}
[0m14:08:20.586849 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.586849 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.fct_sales ............................... [[32mOK[0m in 0.03s]
[0m14:08:20.587849 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: Close
[0m14:08:20.588848 [debug] [Thread-1 (]: Finished running node model.duckdb_poc.fct_sales
[0m14:08:20.588848 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64FD88B60>]}
[0m14:08:20.589847 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_customer ............................ [[32mOK[0m in 0.03s]
[0m14:08:20.589847 [debug] [Thread-4 (]: Finished running node model.duckdb_poc.dim_customer
[0m14:08:20.589847 [debug] [Thread-3 (]: Began running node model.duckdb_poc.sales_with_customer
[0m14:08:20.590849 [info ] [Thread-3 (]: 5 of 5 START sql table model main.sales_with_customer .......................... [RUN]
[0m14:08:20.590849 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.duckdb_poc.sales_with_customer'
[0m14:08:20.591849 [debug] [Thread-3 (]: Began compiling node model.duckdb_poc.sales_with_customer
[0m14:08:20.593847 [debug] [Thread-3 (]: Writing injected SQL for node "model.duckdb_poc.sales_with_customer"
[0m14:08:20.593847 [debug] [Thread-3 (]: Began executing node model.duckdb_poc.sales_with_customer
[0m14:08:20.596847 [debug] [Thread-3 (]: Writing runtime sql for node "model.duckdb_poc.sales_with_customer"
[0m14:08:20.597847 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:08:20.597847 [debug] [Thread-3 (]: On model.duckdb_poc.sales_with_customer: BEGIN
[0m14:08:20.598848 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:08:20.598848 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:08:20.598848 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:08:20.598848 [debug] [Thread-3 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */

  
    
    

    create  table
      "duck_poc"."main"."sales_with_customer__dbt_tmp"
  
    as (
      
select
  f.sales_id,
  f.sale_ts,
  f.amount,
  f.currency_code,
  c.customer_id,
  c.customer_name,
  c.email,
  c.region_code
from "duck_poc"."main"."fct_sales" f
join "duck_poc"."main"."dim_customer" c
  on c.customer_id = f.customer_id
    );
  
  
[0m14:08:20.600923 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.602930 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:08:20.602930 [debug] [Thread-3 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */
alter table "duck_poc"."main"."sales_with_customer__dbt_tmp" rename to "sales_with_customer"
[0m14:08:20.602930 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:08:20.603922 [debug] [Thread-3 (]: On model.duckdb_poc.sales_with_customer: COMMIT
[0m14:08:20.604922 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:08:20.604922 [debug] [Thread-3 (]: On model.duckdb_poc.sales_with_customer: COMMIT
[0m14:08:20.605922 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:08:20.606922 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:08:20.606922 [debug] [Thread-3 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */

      drop table if exists "duck_poc"."main"."sales_with_customer__dbt_backup" cascade
    
[0m14:08:20.607922 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:08:20.607922 [debug] [Thread-3 (]: On model.duckdb_poc.sales_with_customer: Close
[0m14:08:20.608925 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77c704d6-dbc3-42d6-b824-70153316e3fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64F82FC50>]}
[0m14:08:20.608925 [info ] [Thread-3 (]: 5 of 5 OK created sql table model main.sales_with_customer ..................... [[32mOK[0m in 0.02s]
[0m14:08:20.609925 [debug] [Thread-3 (]: Finished running node model.duckdb_poc.sales_with_customer
[0m14:08:20.609925 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:20.610922 [debug] [MainThread]: On master: BEGIN
[0m14:08:20.610922 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:20.610922 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:20.610922 [debug] [MainThread]: On master: COMMIT
[0m14:08:20.611922 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:20.611922 [debug] [MainThread]: On master: COMMIT
[0m14:08:20.611922 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:20.611922 [debug] [MainThread]: On master: Close
[0m14:08:20.612924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:20.612924 [debug] [MainThread]: Connection 'create_duck_poc_main' was properly closed.
[0m14:08:20.612924 [debug] [MainThread]: Connection 'list_duck_poc_main' was properly closed.
[0m14:08:20.612924 [debug] [MainThread]: Connection 'model.duckdb_poc.fct_sales' was properly closed.
[0m14:08:20.612924 [debug] [MainThread]: Connection 'model.duckdb_poc.sales_d1' was properly closed.
[0m14:08:20.612924 [debug] [MainThread]: Connection 'model.duckdb_poc.dim_customer' was properly closed.
[0m14:08:20.612924 [debug] [MainThread]: Connection 'model.duckdb_poc.sales_with_customer' was properly closed.
[0m14:08:20.613930 [info ] [MainThread]: 
[0m14:08:20.614180 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m14:08:20.615191 [debug] [MainThread]: Command end result
[0m14:08:20.628190 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\manifest.json
[0m14:08:20.629190 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\semantic_manifest.json
[0m14:08:20.634190 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\run_results.json
[0m14:08:20.634190 [info ] [MainThread]: 
[0m14:08:20.634190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:20.634190 [info ] [MainThread]: 
[0m14:08:20.635190 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m14:08:20.635190 [debug] [MainThread]: Command `dbt run` succeeded at 14:08:20.635190 after 2.19 seconds
[0m14:08:20.636189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64DBB2D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64D7191C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A64D718320>]}
[0m14:08:20.636189 [debug] [MainThread]: Flushing usage events
[0m14:08:20.805085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:03.097792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119C1D6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1C8AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1C8A6C0>]}


============================== 14:41:03.097792 | d81883a1-fb2f-4640-a8c8-f76cbb00a84a ==============================
[0m14:41:03.097792 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:41:03.097792 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project'}
[0m14:41:03.304358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd81883a1-fb2f-4640-a8c8-f76cbb00a84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A36BE1B0>]}
[0m14:41:03.356578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd81883a1-fb2f-4640-a8c8-f76cbb00a84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A355D0A0>]}
[0m14:41:03.356578 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:41:03.472904 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m14:41:03.564340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:03.564340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:03.584255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd81883a1-fb2f-4640-a8c8-f76cbb00a84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A39B5C10>]}
[0m14:41:03.631778 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\manifest.json
[0m14:41:03.631778 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\semantic_manifest.json
[0m14:41:03.649163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd81883a1-fb2f-4640-a8c8-f76cbb00a84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A3BA6D50>]}
[0m14:41:03.649163 [info ] [MainThread]: Found 5 models, 15 data tests, 429 macros
[0m14:41:03.649163 [info ] [MainThread]: 
[0m14:41:03.663250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:03.663611 [info ] [MainThread]: 
[0m14:41:03.663611 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:41:03.667225 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duck_poc'
[0m14:41:03.715847 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc"
[0m14:41:03.715847 [debug] [ThreadPool]: On list_duck_poc: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "list_duck_poc"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duck_poc"'
    
  
  
[0m14:41:03.716843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:03.724967 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m14:41:03.724967 [debug] [ThreadPool]: On list_duck_poc: Close
[0m14:41:03.724967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duck_poc, now create_duck_poc_main)
[0m14:41:03.724967 [debug] [ThreadPool]: Creating schema "database: "duck_poc"
schema: "main"
"
[0m14:41:03.732607 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:41:03.732607 [debug] [ThreadPool]: On create_duck_poc_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "create_duck_poc_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duck_poc'
        and type='sqlite'
    
  
[0m14:41:03.732607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:03.734610 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:41:03.734610 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:41:03.734610 [debug] [ThreadPool]: On create_duck_poc_main: BEGIN
[0m14:41:03.734610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:03.734610 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:41:03.734610 [debug] [ThreadPool]: On create_duck_poc_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "create_duck_poc_main"} */

    
    
        create schema if not exists "duck_poc"."main"
    
[0m14:41:03.736614 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:03.736614 [debug] [ThreadPool]: On create_duck_poc_main: COMMIT
[0m14:41:03.736614 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:41:03.736614 [debug] [ThreadPool]: On create_duck_poc_main: COMMIT
[0m14:41:03.736614 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:03.736614 [debug] [ThreadPool]: On create_duck_poc_main: Close
[0m14:41:03.736614 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duck_poc_main'
[0m14:41:03.740943 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc_main"
[0m14:41:03.740943 [debug] [ThreadPool]: On list_duck_poc_main: BEGIN
[0m14:41:03.740943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:03.742946 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:03.742946 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc_main"
[0m14:41:03.742946 [debug] [ThreadPool]: On list_duck_poc_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "list_duck_poc_main"} */
select
      'duck_poc' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duck_poc'
  
[0m14:41:03.748955 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:41:03.750958 [debug] [ThreadPool]: On list_duck_poc_main: ROLLBACK
[0m14:41:03.752961 [debug] [ThreadPool]: Failed to rollback 'list_duck_poc_main'
[0m14:41:03.752961 [debug] [ThreadPool]: On list_duck_poc_main: Close
[0m14:41:03.752961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd81883a1-fb2f-4640-a8c8-f76cbb00a84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A36CCEF0>]}
[0m14:41:03.752961 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:03.752961 [debug] [MainThread]: On master: BEGIN
[0m14:41:03.752961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:03.752961 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:03.752961 [debug] [MainThread]: On master: COMMIT
[0m14:41:03.752961 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:03.752961 [debug] [MainThread]: On master: COMMIT
[0m14:41:03.752961 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:03.752961 [debug] [MainThread]: On master: Close
[0m14:41:03.756849 [debug] [Thread-1 (]: Began running node model.duckdb_poc.customers_d1
[0m14:41:03.756849 [debug] [Thread-2 (]: Began running node model.duckdb_poc.sales_d1
[0m14:41:03.756849 [info ] [Thread-1 (]: 1 of 20 START sql table model main.customers_d1 ................................ [RUN]
[0m14:41:03.756849 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.duckdb_poc.customers_d1'
[0m14:41:03.756849 [info ] [Thread-2 (]: 2 of 20 START sql table model main.sales_d1 .................................... [RUN]
[0m14:41:03.756849 [debug] [Thread-1 (]: Began compiling node model.duckdb_poc.customers_d1
[0m14:41:03.756849 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.duckdb_poc.sales_d1'
[0m14:41:03.764414 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_poc.customers_d1"
[0m14:41:03.764414 [debug] [Thread-2 (]: Began compiling node model.duckdb_poc.sales_d1
[0m14:41:03.764414 [debug] [Thread-2 (]: Writing injected SQL for node "model.duckdb_poc.sales_d1"
[0m14:41:03.764414 [debug] [Thread-1 (]: Began executing node model.duckdb_poc.customers_d1
[0m14:41:03.772487 [debug] [Thread-2 (]: Began executing node model.duckdb_poc.sales_d1
[0m14:41:03.792232 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_poc.customers_d1"
[0m14:41:03.792232 [debug] [Thread-2 (]: Writing runtime sql for node "model.duckdb_poc.sales_d1"
[0m14:41:03.793232 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:03.793232 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: BEGIN
[0m14:41:03.793232 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:41:03.793232 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:03.793232 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: BEGIN
[0m14:41:03.793232 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.793232 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:03.793232 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:03.793232 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */

  
    
    

    create  table
      "duck_poc"."main"."sales_d1__dbt_tmp"
  
    as (
      
-- Treat CSVs under /data as your D0 snapshots
select
  cast(sales_id as integer) as sales_id,
  customer_id,
  cast(amount as double) as amount,
  currency_code,
  cast(event_ts as timestamp) as event_ts,
  cast(load_hour as timestamp) as load_hour
from read_csv_auto('../data/sales_2025-08-31-10.csv', header=True)
    );
  
  
[0m14:41:03.793232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.793232 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:03.793232 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */

  
    
    

    create  table
      "duck_poc"."main"."customers_d1__dbt_tmp"
  
    as (
      
select
  customer_id,
  upper(trim(customer_name)) as customer_name,
  email,
  region_code,
  cast(load_hour as timestamp) as load_hour
from read_csv_auto('../data/customers_2025-08-31-10.csv', header=True)
    );
  
  
[0m14:41:03.800048 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:41:03.804054 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:03.804054 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:41:03.804054 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */
alter table "duck_poc"."main"."customers_d1" rename to "customers_d1__dbt_backup"
[0m14:41:03.807891 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:03.807891 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */
alter table "duck_poc"."main"."sales_d1" rename to "sales_d1__dbt_backup"
[0m14:41:03.807891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:41:03.809894 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:03.809894 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */
alter table "duck_poc"."main"."customers_d1__dbt_tmp" rename to "customers_d1"
[0m14:41:03.809894 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.811894 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:03.811894 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */
alter table "duck_poc"."main"."sales_d1__dbt_tmp" rename to "sales_d1"
[0m14:41:03.812894 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.821976 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: COMMIT
[0m14:41:03.822975 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:03.822975 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m14:41:03.822975 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: COMMIT
[0m14:41:03.824976 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: COMMIT
[0m14:41:03.824976 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:03.824976 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: COMMIT
[0m14:41:03.824976 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.829585 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:03.829585 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */

      drop table if exists "duck_poc"."main"."customers_d1__dbt_backup" cascade
    
[0m14:41:03.829585 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:41:03.829585 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:03.829585 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */

      drop table if exists "duck_poc"."main"."sales_d1__dbt_backup" cascade
    
[0m14:41:03.829585 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.829585 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: Close
[0m14:41:03.835206 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.835206 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: Close
[0m14:41:03.835206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd81883a1-fb2f-4640-a8c8-f76cbb00a84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A364C7A0>]}
[0m14:41:03.835206 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd81883a1-fb2f-4640-a8c8-f76cbb00a84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A364C620>]}
[0m14:41:03.835206 [info ] [Thread-1 (]: 1 of 20 OK created sql table model main.customers_d1 ........................... [[32mOK[0m in 0.08s]
[0m14:41:03.835206 [debug] [Thread-1 (]: Finished running node model.duckdb_poc.customers_d1
[0m14:41:03.835206 [info ] [Thread-2 (]: 2 of 20 OK created sql table model main.sales_d1 ............................... [[32mOK[0m in 0.08s]
[0m14:41:03.835206 [debug] [Thread-2 (]: Finished running node model.duckdb_poc.sales_d1
[0m14:41:03.835206 [debug] [Thread-4 (]: Began running node test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31
[0m14:41:03.835206 [debug] [Thread-2 (]: Began running node test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6
[0m14:41:03.835206 [debug] [Thread-3 (]: Began running node test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a
[0m14:41:03.835206 [debug] [Thread-1 (]: Began running node test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b
[0m14:41:03.840674 [info ] [Thread-4 (]: 3 of 20 START test not_null_customers_d1_customer_id ........................... [RUN]
[0m14:41:03.840674 [info ] [Thread-2 (]: 4 of 20 START test not_null_customers_d1_customer_name ......................... [RUN]
[0m14:41:03.840674 [info ] [Thread-3 (]: 5 of 20 START test not_null_customers_d1_email ................................. [RUN]
[0m14:41:03.840674 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31'
[0m14:41:03.840674 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.duckdb_poc.sales_d1, now test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6)
[0m14:41:03.840674 [info ] [Thread-1 (]: 6 of 20 START test unique_customers_d1_customer_id ............................. [RUN]
[0m14:41:03.840674 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a'
[0m14:41:03.840674 [debug] [Thread-4 (]: Began compiling node test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31
[0m14:41:03.840674 [debug] [Thread-2 (]: Began compiling node test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6
[0m14:41:03.840674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.duckdb_poc.customers_d1, now test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b)
[0m14:41:03.840674 [debug] [Thread-3 (]: Began compiling node test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a
[0m14:41:03.849750 [debug] [Thread-4 (]: Writing injected SQL for node "test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31"
[0m14:41:03.849750 [debug] [Thread-2 (]: Writing injected SQL for node "test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6"
[0m14:41:03.849750 [debug] [Thread-1 (]: Began compiling node test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b
[0m14:41:03.849750 [debug] [Thread-3 (]: Writing injected SQL for node "test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a"
[0m14:41:03.859283 [debug] [Thread-1 (]: Writing injected SQL for node "test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b"
[0m14:41:03.860284 [debug] [Thread-2 (]: Began executing node test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6
[0m14:41:03.867282 [debug] [Thread-2 (]: Writing runtime sql for node "test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6"
[0m14:41:03.867282 [debug] [Thread-3 (]: Began executing node test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a
[0m14:41:03.867282 [debug] [Thread-3 (]: Writing runtime sql for node "test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a"
[0m14:41:03.867282 [debug] [Thread-4 (]: Began executing node test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31
[0m14:41:03.867282 [debug] [Thread-1 (]: Began executing node test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b
[0m14:41:03.874429 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6"
[0m14:41:03.874429 [debug] [Thread-4 (]: Writing runtime sql for node "test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31"
[0m14:41:03.874429 [debug] [Thread-1 (]: Writing runtime sql for node "test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b"
[0m14:41:03.874429 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6: BEGIN
[0m14:41:03.874429 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:03.874429 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a"
[0m14:41:03.874429 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a: BEGIN
[0m14:41:03.874429 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31"
[0m14:41:03.874429 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.874429 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:03.874429 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31: BEGIN
[0m14:41:03.874429 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b"
[0m14:41:03.874429 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6"
[0m14:41:03.874429 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:41:03.874429 [debug] [Thread-1 (]: On test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b: BEGIN
[0m14:41:03.874429 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.874429 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "duck_poc"."main"."customers_d1"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m14:41:03.874429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:03.874429 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.874429 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a"
[0m14:41:03.874429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.882807 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31"
[0m14:41:03.882807 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.882807 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "duck_poc"."main"."customers_d1"
where email is null



  
  
      
    ) dbt_internal_test
[0m14:41:03.883811 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b"
[0m14:41:03.883811 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "duck_poc"."main"."customers_d1"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:03.883811 [debug] [Thread-1 (]: On test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "duck_poc"."main"."customers_d1"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:41:03.885811 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6: ROLLBACK
[0m14:41:03.886510 [debug] [Thread-2 (]: Failed to rollback 'test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6'
[0m14:41:03.887517 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:41:03.887517 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6: Close
[0m14:41:03.887517 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.887517 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.888516 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a: ROLLBACK
[0m14:41:03.890516 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31: ROLLBACK
[0m14:41:03.889515 [info ] [Thread-2 (]: 4 of 20 PASS not_null_customers_d1_customer_name ............................... [[32mPASS[0m in 0.05s]
[0m14:41:03.891152 [debug] [Thread-1 (]: On test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b: ROLLBACK
[0m14:41:03.892175 [debug] [Thread-3 (]: Failed to rollback 'test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a'
[0m14:41:03.892175 [debug] [Thread-2 (]: Finished running node test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6
[0m14:41:03.892175 [debug] [Thread-4 (]: Failed to rollback 'test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31'
[0m14:41:03.893175 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a: Close
[0m14:41:03.893175 [debug] [Thread-1 (]: Failed to rollback 'test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b'
[0m14:41:03.894174 [debug] [Thread-2 (]: Began running node test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a
[0m14:41:03.894174 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31: Close
[0m14:41:03.894174 [debug] [Thread-1 (]: On test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b: Close
[0m14:41:03.894174 [info ] [Thread-3 (]: 5 of 20 PASS not_null_customers_d1_email ....................................... [[32mPASS[0m in 0.05s]
[0m14:41:03.895175 [info ] [Thread-2 (]: 7 of 20 START test not_null_sales_d1_customer_id ............................... [RUN]
[0m14:41:03.895175 [info ] [Thread-4 (]: 3 of 20 PASS not_null_customers_d1_customer_id ................................. [[32mPASS[0m in 0.05s]
[0m14:41:03.896464 [debug] [Thread-3 (]: Finished running node test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a
[0m14:41:03.896464 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6, now test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a)
[0m14:41:03.895175 [info ] [Thread-1 (]: 6 of 20 PASS unique_customers_d1_customer_id ................................... [[32mPASS[0m in 0.05s]
[0m14:41:03.896464 [debug] [Thread-4 (]: Finished running node test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31
[0m14:41:03.897464 [debug] [Thread-3 (]: Began running node test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3
[0m14:41:03.897464 [debug] [Thread-2 (]: Began compiling node test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a
[0m14:41:03.897464 [debug] [Thread-1 (]: Finished running node test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b
[0m14:41:03.897464 [debug] [Thread-4 (]: Began running node test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2
[0m14:41:03.901728 [debug] [Thread-2 (]: Writing injected SQL for node "test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a"
[0m14:41:03.898463 [info ] [Thread-3 (]: 8 of 20 START test not_null_sales_d1_event_ts .................................. [RUN]
[0m14:41:03.901728 [debug] [Thread-1 (]: Began running node test.duckdb_poc.unique_sales_d1_sales_id.506a998370
[0m14:41:03.901728 [info ] [Thread-4 (]: 9 of 20 START test not_null_sales_d1_sales_id .................................. [RUN]
[0m14:41:03.903027 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a, now test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3)
[0m14:41:03.903027 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31, now test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2)
[0m14:41:03.904027 [debug] [Thread-3 (]: Began compiling node test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3
[0m14:41:03.903027 [info ] [Thread-1 (]: 10 of 20 START test unique_sales_d1_sales_id ................................... [RUN]
[0m14:41:03.904027 [debug] [Thread-4 (]: Began compiling node test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2
[0m14:41:03.904027 [debug] [Thread-2 (]: Began executing node test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a
[0m14:41:03.934851 [debug] [Thread-3 (]: Writing injected SQL for node "test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3"
[0m14:41:03.934851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b, now test.duckdb_poc.unique_sales_d1_sales_id.506a998370)
[0m14:41:03.936851 [debug] [Thread-4 (]: Writing injected SQL for node "test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2"
[0m14:41:03.938852 [debug] [Thread-2 (]: Writing runtime sql for node "test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a"
[0m14:41:03.938852 [debug] [Thread-1 (]: Began compiling node test.duckdb_poc.unique_sales_d1_sales_id.506a998370
[0m14:41:03.941268 [debug] [Thread-1 (]: Writing injected SQL for node "test.duckdb_poc.unique_sales_d1_sales_id.506a998370"
[0m14:41:03.942287 [debug] [Thread-3 (]: Began executing node test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3
[0m14:41:03.943288 [debug] [Thread-3 (]: Writing runtime sql for node "test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3"
[0m14:41:03.944288 [debug] [Thread-4 (]: Began executing node test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2
[0m14:41:03.944288 [debug] [Thread-1 (]: Began executing node test.duckdb_poc.unique_sales_d1_sales_id.506a998370
[0m14:41:03.944288 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a"
[0m14:41:03.946294 [debug] [Thread-4 (]: Writing runtime sql for node "test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2"
[0m14:41:03.947287 [debug] [Thread-1 (]: Writing runtime sql for node "test.duckdb_poc.unique_sales_d1_sales_id.506a998370"
[0m14:41:03.948027 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a: BEGIN
[0m14:41:03.948027 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3"
[0m14:41:03.948027 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:03.949035 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3: BEGIN
[0m14:41:03.949035 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2"
[0m14:41:03.950035 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:41:03.950035 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2: BEGIN
[0m14:41:03.950035 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.unique_sales_d1_sales_id.506a998370"
[0m14:41:03.950035 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.951035 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:41:03.951035 [debug] [Thread-1 (]: On test.duckdb_poc.unique_sales_d1_sales_id.506a998370: BEGIN
[0m14:41:03.951035 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.951035 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a"
[0m14:41:03.951035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:03.951035 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.951035 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3"
[0m14:41:03.951035 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "duck_poc"."main"."sales_d1"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:03.951035 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2"
[0m14:41:03.951035 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.951035 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from "duck_poc"."main"."sales_d1"
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m14:41:03.951035 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_id
from "duck_poc"."main"."sales_d1"
where sales_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:03.951035 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.unique_sales_d1_sales_id.506a998370"
[0m14:41:03.951035 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.951035 [debug] [Thread-1 (]: On test.duckdb_poc.unique_sales_d1_sales_id.506a998370: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.unique_sales_d1_sales_id.506a998370"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sales_id as unique_field,
    count(*) as n_records

from "duck_poc"."main"."sales_d1"
where sales_id is not null
group by sales_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:41:03.951035 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a: ROLLBACK
[0m14:41:03.951035 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.951035 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.951035 [debug] [Thread-2 (]: Failed to rollback 'test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a'
[0m14:41:03.951035 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a: Close
[0m14:41:03.951035 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3: ROLLBACK
[0m14:41:03.951035 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2: ROLLBACK
[0m14:41:03.951035 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:41:03.951035 [info ] [Thread-2 (]: 7 of 20 PASS not_null_sales_d1_customer_id ..................................... [[32mPASS[0m in 0.05s]
[0m14:41:03.951035 [debug] [Thread-3 (]: Failed to rollback 'test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3'
[0m14:41:03.951035 [debug] [Thread-4 (]: Failed to rollback 'test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2'
[0m14:41:03.951035 [debug] [Thread-1 (]: On test.duckdb_poc.unique_sales_d1_sales_id.506a998370: ROLLBACK
[0m14:41:03.951035 [debug] [Thread-2 (]: Finished running node test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a
[0m14:41:03.951035 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3: Close
[0m14:41:03.951035 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2: Close
[0m14:41:03.951035 [debug] [Thread-2 (]: Began running node model.duckdb_poc.dim_customer
[0m14:41:03.951035 [debug] [Thread-1 (]: Failed to rollback 'test.duckdb_poc.unique_sales_d1_sales_id.506a998370'
[0m14:41:03.951035 [info ] [Thread-3 (]: 8 of 20 PASS not_null_sales_d1_event_ts ........................................ [[32mPASS[0m in 0.05s]
[0m14:41:03.951035 [debug] [Thread-1 (]: On test.duckdb_poc.unique_sales_d1_sales_id.506a998370: Close
[0m14:41:03.951035 [info ] [Thread-4 (]: 9 of 20 PASS not_null_sales_d1_sales_id ........................................ [[32mPASS[0m in 0.05s]
[0m14:41:03.951035 [debug] [Thread-3 (]: Finished running node test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3
[0m14:41:03.965433 [debug] [Thread-4 (]: Finished running node test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2
[0m14:41:03.951035 [info ] [Thread-2 (]: 11 of 20 START sql table model main.dim_customer ............................... [RUN]
[0m14:41:03.965433 [info ] [Thread-1 (]: 10 of 20 PASS unique_sales_d1_sales_id ......................................... [[32mPASS[0m in 0.03s]
[0m14:41:03.966438 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a, now model.duckdb_poc.dim_customer)
[0m14:41:03.966438 [debug] [Thread-1 (]: Finished running node test.duckdb_poc.unique_sales_d1_sales_id.506a998370
[0m14:41:03.966438 [debug] [Thread-2 (]: Began compiling node model.duckdb_poc.dim_customer
[0m14:41:03.967437 [debug] [Thread-3 (]: Began running node model.duckdb_poc.fct_sales
[0m14:41:03.969438 [debug] [Thread-2 (]: Writing injected SQL for node "model.duckdb_poc.dim_customer"
[0m14:41:03.969438 [info ] [Thread-3 (]: 12 of 20 START sql table model main.fct_sales .................................. [RUN]
[0m14:41:03.970438 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3, now model.duckdb_poc.fct_sales)
[0m14:41:03.970438 [debug] [Thread-3 (]: Began compiling node model.duckdb_poc.fct_sales
[0m14:41:03.972437 [debug] [Thread-3 (]: Writing injected SQL for node "model.duckdb_poc.fct_sales"
[0m14:41:03.972437 [debug] [Thread-2 (]: Began executing node model.duckdb_poc.dim_customer
[0m14:41:03.974437 [debug] [Thread-2 (]: Writing runtime sql for node "model.duckdb_poc.dim_customer"
[0m14:41:03.975438 [debug] [Thread-3 (]: Began executing node model.duckdb_poc.fct_sales
[0m14:41:03.977794 [debug] [Thread-3 (]: Writing runtime sql for node "model.duckdb_poc.fct_sales"
[0m14:41:03.977794 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:03.977794 [debug] [Thread-2 (]: On model.duckdb_poc.dim_customer: BEGIN
[0m14:41:03.977794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:03.977794 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:03.977794 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.977794 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: BEGIN
[0m14:41:03.977794 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:03.977794 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:41:03.977794 [debug] [Thread-2 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */

  
    
    

    create  table
      "duck_poc"."main"."dim_customer__dbt_tmp"
  
    as (
      
select
  customer_id,
  any_value(customer_name) as customer_name,
  any_value(email) as email,
  any_value(region_code) as region_code
from "duck_poc"."main"."customers_d1"
group by customer_id
    );
  
  
[0m14:41:03.977794 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.977794 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:03.977794 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */

  
    
    

    create  table
      "duck_poc"."main"."fct_sales__dbt_tmp"
  
    as (
      
select
  sales_id,
  event_ts as sale_ts,
  amount,
  currency_code,
  customer_id
from "duck_poc"."main"."sales_d1"
    );
  
  
[0m14:41:03.977794 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.984565 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:03.984565 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:41:03.985602 [debug] [Thread-2 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */
alter table "duck_poc"."main"."dim_customer" rename to "dim_customer__dbt_backup"
[0m14:41:03.986612 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:03.987611 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */
alter table "duck_poc"."main"."fct_sales" rename to "fct_sales__dbt_backup"
[0m14:41:03.987611 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:41:03.988611 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:03.988611 [debug] [Thread-2 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */
alter table "duck_poc"."main"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m14:41:03.988611 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.992112 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:03.992112 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */
alter table "duck_poc"."main"."fct_sales__dbt_tmp" rename to "fct_sales"
[0m14:41:03.992112 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.992880 [debug] [Thread-2 (]: On model.duckdb_poc.dim_customer: COMMIT
[0m14:41:03.992880 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:03.992880 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.992880 [debug] [Thread-2 (]: On model.duckdb_poc.dim_customer: COMMIT
[0m14:41:03.992880 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: COMMIT
[0m14:41:03.992880 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:03.992880 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: COMMIT
[0m14:41:03.992880 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.992880 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:03.992880 [debug] [Thread-2 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */

      drop table if exists "duck_poc"."main"."dim_customer__dbt_backup" cascade
    
[0m14:41:03.998932 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.999854 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:03.999854 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:41:03.999854 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */

      drop table if exists "duck_poc"."main"."fct_sales__dbt_backup" cascade
    
[0m14:41:03.999854 [debug] [Thread-2 (]: On model.duckdb_poc.dim_customer: Close
[0m14:41:03.999854 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd81883a1-fb2f-4640-a8c8-f76cbb00a84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A40D6810>]}
[0m14:41:03.999854 [info ] [Thread-2 (]: 11 of 20 OK created sql table model main.dim_customer .......................... [[32mOK[0m in 0.03s]
[0m14:41:03.999854 [debug] [Thread-2 (]: Finished running node model.duckdb_poc.dim_customer
[0m14:41:03.999854 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:03.999854 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: Close
[0m14:41:03.999854 [debug] [Thread-1 (]: Began running node test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc
[0m14:41:03.999854 [debug] [Thread-4 (]: Began running node test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1
[0m14:41:03.999854 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd81883a1-fb2f-4640-a8c8-f76cbb00a84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A401C3E0>]}
[0m14:41:03.999854 [info ] [Thread-1 (]: 13 of 20 START test not_null_dim_customer_customer_id .......................... [RUN]
[0m14:41:03.999854 [info ] [Thread-4 (]: 14 of 20 START test unique_dim_customer_customer_id ............................ [RUN]
[0m14:41:03.999854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.unique_sales_d1_sales_id.506a998370, now test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc)
[0m14:41:03.999854 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2, now test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1)
[0m14:41:03.999854 [info ] [Thread-3 (]: 12 of 20 OK created sql table model main.fct_sales ............................. [[32mOK[0m in 0.03s]
[0m14:41:03.999854 [debug] [Thread-1 (]: Began compiling node test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc
[0m14:41:03.999854 [debug] [Thread-4 (]: Began compiling node test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1
[0m14:41:04.007772 [debug] [Thread-3 (]: Finished running node model.duckdb_poc.fct_sales
[0m14:41:04.010476 [debug] [Thread-1 (]: Writing injected SQL for node "test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc"
[0m14:41:04.012615 [debug] [Thread-4 (]: Writing injected SQL for node "test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1"
[0m14:41:04.012615 [debug] [Thread-2 (]: Began running node test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce
[0m14:41:04.013615 [debug] [Thread-3 (]: Began running node test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c
[0m14:41:04.013615 [debug] [Thread-1 (]: Began executing node test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc
[0m14:41:04.016113 [debug] [Thread-1 (]: Writing runtime sql for node "test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc"
[0m14:41:04.016499 [debug] [Thread-4 (]: Began executing node test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1
[0m14:41:04.013615 [info ] [Thread-2 (]: 15 of 20 START test not_null_fct_sales_customer_id ............................. [RUN]
[0m14:41:04.016499 [debug] [Thread-4 (]: Writing runtime sql for node "test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1"
[0m14:41:04.013615 [info ] [Thread-3 (]: 16 of 20 START test not_null_fct_sales_sales_id ................................ [RUN]
[0m14:41:04.016499 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.duckdb_poc.dim_customer, now test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce)
[0m14:41:04.016499 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.duckdb_poc.fct_sales, now test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c)
[0m14:41:04.016499 [debug] [Thread-2 (]: Began compiling node test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce
[0m14:41:04.016499 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc"
[0m14:41:04.016499 [debug] [Thread-3 (]: Began compiling node test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c
[0m14:41:04.016499 [debug] [Thread-2 (]: Writing injected SQL for node "test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce"
[0m14:41:04.016499 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc: BEGIN
[0m14:41:04.016499 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1"
[0m14:41:04.026619 [debug] [Thread-3 (]: Writing injected SQL for node "test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c"
[0m14:41:04.026991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:04.026991 [debug] [Thread-4 (]: On test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1: BEGIN
[0m14:41:04.026991 [debug] [Thread-2 (]: Began executing node test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce
[0m14:41:04.028018 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:41:04.028018 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:41:04.030017 [debug] [Thread-2 (]: Writing runtime sql for node "test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce"
[0m14:41:04.030017 [debug] [Thread-3 (]: Began executing node test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c
[0m14:41:04.030017 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc"
[0m14:41:04.031017 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:41:04.031017 [debug] [Thread-3 (]: Writing runtime sql for node "test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c"
[0m14:41:04.031017 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "duck_poc"."main"."dim_customer"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:04.032822 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1"
[0m14:41:04.033462 [debug] [Thread-4 (]: On test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "duck_poc"."main"."dim_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:41:04.033462 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce"
[0m14:41:04.033462 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce: BEGIN
[0m14:41:04.033462 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:04.034759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.034759 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c"
[0m14:41:04.035759 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.035759 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c: BEGIN
[0m14:41:04.036759 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc: ROLLBACK
[0m14:41:04.036759 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce"
[0m14:41:04.036759 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:41:04.036759 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:41:04.037766 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "duck_poc"."main"."fct_sales"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:04.037766 [debug] [Thread-1 (]: Failed to rollback 'test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc'
[0m14:41:04.038758 [debug] [Thread-4 (]: On test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1: ROLLBACK
[0m14:41:04.038758 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc: Close
[0m14:41:04.038758 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:04.038758 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.041109 [debug] [Thread-4 (]: Failed to rollback 'test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1'
[0m14:41:04.041109 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c"
[0m14:41:04.041109 [info ] [Thread-1 (]: 13 of 20 PASS not_null_dim_customer_customer_id ................................ [[32mPASS[0m in 0.04s]
[0m14:41:04.042694 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce: ROLLBACK
[0m14:41:04.042694 [debug] [Thread-4 (]: On test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1: Close
[0m14:41:04.043197 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_id
from "duck_poc"."main"."fct_sales"
where sales_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:04.043197 [debug] [Thread-1 (]: Finished running node test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc
[0m14:41:04.043197 [debug] [Thread-2 (]: Failed to rollback 'test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce'
[0m14:41:04.043197 [info ] [Thread-4 (]: 14 of 20 PASS unique_dim_customer_customer_id .................................. [[32mPASS[0m in 0.04s]
[0m14:41:04.043197 [debug] [Thread-1 (]: Began running node test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392
[0m14:41:04.043197 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce: Close
[0m14:41:04.043197 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.043197 [debug] [Thread-4 (]: Finished running node test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1
[0m14:41:04.043197 [info ] [Thread-1 (]: 17 of 20 START test relationships_fct_sales_customer_id__customer_id__ref_dim_customer_  [RUN]
[0m14:41:04.043197 [debug] [Thread-4 (]: Began running node test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816
[0m14:41:04.047047 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c: ROLLBACK
[0m14:41:04.043197 [info ] [Thread-2 (]: 15 of 20 PASS not_null_fct_sales_customer_id ................................... [[32mPASS[0m in 0.03s]
[0m14:41:04.048051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc, now test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392)
[0m14:41:04.048051 [info ] [Thread-4 (]: 18 of 20 START test unique_fct_sales_sales_id .................................. [RUN]
[0m14:41:04.048051 [debug] [Thread-2 (]: Finished running node test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce
[0m14:41:04.049051 [debug] [Thread-3 (]: Failed to rollback 'test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c'
[0m14:41:04.049051 [debug] [Thread-1 (]: Began compiling node test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392
[0m14:41:04.050050 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1, now test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816)
[0m14:41:04.050050 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c: Close
[0m14:41:04.053263 [debug] [Thread-1 (]: Writing injected SQL for node "test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392"
[0m14:41:04.053263 [debug] [Thread-4 (]: Began compiling node test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816
[0m14:41:04.058495 [debug] [Thread-4 (]: Writing injected SQL for node "test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816"
[0m14:41:04.053263 [info ] [Thread-3 (]: 16 of 20 PASS not_null_fct_sales_sales_id ...................................... [[32mPASS[0m in 0.04s]
[0m14:41:04.059424 [debug] [Thread-3 (]: Finished running node test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c
[0m14:41:04.059424 [debug] [Thread-4 (]: Began executing node test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816
[0m14:41:04.060644 [debug] [Thread-1 (]: Began executing node test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392
[0m14:41:04.061646 [debug] [Thread-4 (]: Writing runtime sql for node "test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816"
[0m14:41:04.062645 [debug] [Thread-1 (]: Writing runtime sql for node "test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392"
[0m14:41:04.062645 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816"
[0m14:41:04.062645 [debug] [Thread-4 (]: On test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816: BEGIN
[0m14:41:04.062645 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392"
[0m14:41:04.062645 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:41:04.062645 [debug] [Thread-1 (]: On test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392: BEGIN
[0m14:41:04.066108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:04.066590 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.066590 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816"
[0m14:41:04.067244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.067608 [debug] [Thread-4 (]: On test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sales_id as unique_field,
    count(*) as n_records

from "duck_poc"."main"."fct_sales"
where sales_id is not null
group by sales_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:41:04.067608 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392"
[0m14:41:04.067608 [debug] [Thread-1 (]: On test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "duck_poc"."main"."fct_sales"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "duck_poc"."main"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:41:04.068608 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.069608 [debug] [Thread-4 (]: On test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816: ROLLBACK
[0m14:41:04.069608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.069608 [debug] [Thread-4 (]: Failed to rollback 'test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816'
[0m14:41:04.070615 [debug] [Thread-4 (]: On test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816: Close
[0m14:41:04.071615 [debug] [Thread-1 (]: On test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392: ROLLBACK
[0m14:41:04.072608 [debug] [Thread-1 (]: Failed to rollback 'test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392'
[0m14:41:04.071615 [info ] [Thread-4 (]: 18 of 20 PASS unique_fct_sales_sales_id ........................................ [[32mPASS[0m in 0.02s]
[0m14:41:04.072608 [debug] [Thread-1 (]: On test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392: Close
[0m14:41:04.072608 [debug] [Thread-4 (]: Finished running node test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816
[0m14:41:04.073607 [info ] [Thread-1 (]: 17 of 20 PASS relationships_fct_sales_customer_id__customer_id__ref_dim_customer_  [[32mPASS[0m in 0.02s]
[0m14:41:04.073607 [debug] [Thread-1 (]: Finished running node test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392
[0m14:41:04.074436 [debug] [Thread-2 (]: Began running node model.duckdb_poc.sales_with_customer
[0m14:41:04.074436 [info ] [Thread-2 (]: 19 of 20 START sql table model main.sales_with_customer ........................ [RUN]
[0m14:41:04.074436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce, now model.duckdb_poc.sales_with_customer)
[0m14:41:04.075440 [debug] [Thread-2 (]: Began compiling node model.duckdb_poc.sales_with_customer
[0m14:41:04.077527 [debug] [Thread-2 (]: Writing injected SQL for node "model.duckdb_poc.sales_with_customer"
[0m14:41:04.077527 [debug] [Thread-2 (]: Began executing node model.duckdb_poc.sales_with_customer
[0m14:41:04.077527 [debug] [Thread-2 (]: Writing runtime sql for node "model.duckdb_poc.sales_with_customer"
[0m14:41:04.077527 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:04.077527 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: BEGIN
[0m14:41:04.077527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:04.077527 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:41:04.077527 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:04.077527 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */

  
    
    

    create  table
      "duck_poc"."main"."sales_with_customer__dbt_tmp"
  
    as (
      
select
  f.sales_id,
  f.sale_ts,
  f.amount,
  f.currency_code,
  c.customer_id,
  c.customer_name,
  c.email,
  c.region_code
from "duck_poc"."main"."fct_sales" f
join "duck_poc"."main"."dim_customer" c
  on c.customer_id = f.customer_id
    );
  
  
[0m14:41:04.083208 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.084766 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:04.084766 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */
alter table "duck_poc"."main"."sales_with_customer" rename to "sales_with_customer__dbt_backup"
[0m14:41:04.085759 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:41:04.086751 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:04.087751 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */
alter table "duck_poc"."main"."sales_with_customer__dbt_tmp" rename to "sales_with_customer"
[0m14:41:04.087751 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:41:04.088751 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: COMMIT
[0m14:41:04.088751 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:04.088751 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: COMMIT
[0m14:41:04.088751 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.092907 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:04.092907 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */

      drop table if exists "duck_poc"."main"."sales_with_customer__dbt_backup" cascade
    
[0m14:41:04.092907 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:04.092907 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: Close
[0m14:41:04.092907 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd81883a1-fb2f-4640-a8c8-f76cbb00a84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A41B8EC0>]}
[0m14:41:04.092907 [info ] [Thread-2 (]: 19 of 20 OK created sql table model main.sales_with_customer ................... [[32mOK[0m in 0.02s]
[0m14:41:04.092907 [debug] [Thread-2 (]: Finished running node model.duckdb_poc.sales_with_customer
[0m14:41:04.092907 [debug] [Thread-4 (]: Began running node test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e
[0m14:41:04.092907 [info ] [Thread-4 (]: 20 of 20 START test not_null_sales_with_customer_sales_id ...................... [RUN]
[0m14:41:04.092907 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816, now test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e)
[0m14:41:04.092907 [debug] [Thread-4 (]: Began compiling node test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e
[0m14:41:04.099867 [debug] [Thread-4 (]: Writing injected SQL for node "test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e"
[0m14:41:04.099867 [debug] [Thread-4 (]: Began executing node test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e
[0m14:41:04.099867 [debug] [Thread-4 (]: Writing runtime sql for node "test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e"
[0m14:41:04.099867 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e"
[0m14:41:04.099867 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e: BEGIN
[0m14:41:04.099867 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:41:04.099867 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:41:04.099867 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e"
[0m14:41:04.099867 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_id
from "duck_poc"."main"."sales_with_customer"
where sales_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:04.099867 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:41:04.099867 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e: ROLLBACK
[0m14:41:04.099867 [debug] [Thread-4 (]: Failed to rollback 'test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e'
[0m14:41:04.099867 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e: Close
[0m14:41:04.099867 [info ] [Thread-4 (]: 20 of 20 PASS not_null_sales_with_customer_sales_id ............................ [[32mPASS[0m in 0.01s]
[0m14:41:04.099867 [debug] [Thread-4 (]: Finished running node test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e
[0m14:41:04.107747 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:04.108723 [debug] [MainThread]: On master: BEGIN
[0m14:41:04.108723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:04.108723 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:04.108723 [debug] [MainThread]: On master: COMMIT
[0m14:41:04.108723 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:04.108723 [debug] [MainThread]: On master: COMMIT
[0m14:41:04.109982 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:04.109982 [debug] [MainThread]: On master: Close
[0m14:41:04.109982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:04.109982 [debug] [MainThread]: Connection 'create_duck_poc_main' was properly closed.
[0m14:41:04.110982 [debug] [MainThread]: Connection 'list_duck_poc_main' was properly closed.
[0m14:41:04.110982 [debug] [MainThread]: Connection 'test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392' was properly closed.
[0m14:41:04.110982 [debug] [MainThread]: Connection 'model.duckdb_poc.sales_with_customer' was properly closed.
[0m14:41:04.110982 [debug] [MainThread]: Connection 'test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e' was properly closed.
[0m14:41:04.110982 [debug] [MainThread]: Connection 'test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c' was properly closed.
[0m14:41:04.111982 [info ] [MainThread]: 
[0m14:41:04.111982 [info ] [MainThread]: Finished running 5 table models, 15 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m14:41:04.112982 [debug] [MainThread]: Command end result
[0m14:41:04.126274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\manifest.json
[0m14:41:04.126274 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\semantic_manifest.json
[0m14:41:04.132793 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\run_results.json
[0m14:41:04.133295 [info ] [MainThread]: 
[0m14:41:04.133295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:04.133844 [info ] [MainThread]: 
[0m14:41:04.133844 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=20
[0m14:41:04.134848 [debug] [MainThread]: Command `dbt build` succeeded at 14:41:04.134848 after 1.11 seconds
[0m14:41:04.134848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1FD1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A386F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A3A46FF0>]}
[0m14:41:04.134848 [debug] [MainThread]: Flushing usage events
[0m14:41:04.291703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:08.348422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874AB49970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874B25E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874B25DA60>]}


============================== 14:41:08.348422 | 985ff985-40e8-4ba0-9f1a-1fbbf1348aa5 ==============================
[0m14:41:08.348422 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:41:08.348422 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'log_path': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project'}
[0m14:41:08.549883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '985ff985-40e8-4ba0-9f1a-1fbbf1348aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D09C980>]}
[0m14:41:08.604939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '985ff985-40e8-4ba0-9f1a-1fbbf1348aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187487BC5C0>]}
[0m14:41:08.606943 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:41:08.732676 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m14:41:08.812687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:08.812687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:08.834715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '985ff985-40e8-4ba0-9f1a-1fbbf1348aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D249D00>]}
[0m14:41:08.869976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\manifest.json
[0m14:41:08.869976 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\semantic_manifest.json
[0m14:41:08.897380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '985ff985-40e8-4ba0-9f1a-1fbbf1348aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D6C0EF0>]}
[0m14:41:08.897380 [info ] [MainThread]: Found 5 models, 15 data tests, 429 macros
[0m14:41:08.897380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '985ff985-40e8-4ba0-9f1a-1fbbf1348aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D67F7A0>]}
[0m14:41:08.897380 [info ] [MainThread]: 
[0m14:41:08.904430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:08.904430 [info ] [MainThread]: 
[0m14:41:08.904430 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:41:08.904430 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duck_poc_main'
[0m14:41:08.951442 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc_main"
[0m14:41:08.951442 [debug] [ThreadPool]: On list_duck_poc_main: BEGIN
[0m14:41:08.951442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:08.966878 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:41:08.966878 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc_main"
[0m14:41:08.966878 [debug] [ThreadPool]: On list_duck_poc_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "list_duck_poc_main"} */
select
      'duck_poc' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duck_poc'
  
[0m14:41:08.966878 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:41:08.966878 [debug] [ThreadPool]: On list_duck_poc_main: ROLLBACK
[0m14:41:08.966878 [debug] [ThreadPool]: Failed to rollback 'list_duck_poc_main'
[0m14:41:08.966878 [debug] [ThreadPool]: On list_duck_poc_main: Close
[0m14:41:08.966878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '985ff985-40e8-4ba0-9f1a-1fbbf1348aa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D09CF20>]}
[0m14:41:08.966878 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:08.966878 [debug] [MainThread]: On master: BEGIN
[0m14:41:08.966878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:08.966878 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:08.966878 [debug] [MainThread]: On master: COMMIT
[0m14:41:08.966878 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:08.966878 [debug] [MainThread]: On master: COMMIT
[0m14:41:08.981329 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:08.981329 [debug] [MainThread]: On master: Close
[0m14:41:08.982832 [debug] [Thread-1 (]: Began running node test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31
[0m14:41:08.982832 [debug] [Thread-2 (]: Began running node test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6
[0m14:41:08.982832 [debug] [Thread-3 (]: Began running node test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a
[0m14:41:08.982832 [info ] [Thread-1 (]: 1 of 15 START test not_null_customers_d1_customer_id ........................... [RUN]
[0m14:41:08.982832 [debug] [Thread-4 (]: Began running node test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc
[0m14:41:08.982832 [info ] [Thread-2 (]: 2 of 15 START test not_null_customers_d1_customer_name ......................... [RUN]
[0m14:41:08.982832 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31'
[0m14:41:08.982832 [info ] [Thread-3 (]: 3 of 15 START test not_null_customers_d1_email ................................. [RUN]
[0m14:41:08.982832 [info ] [Thread-4 (]: 4 of 15 START test not_null_dim_customer_customer_id ........................... [RUN]
[0m14:41:08.982832 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6'
[0m14:41:08.982832 [debug] [Thread-1 (]: Began compiling node test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31
[0m14:41:08.982832 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a'
[0m14:41:08.982832 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc'
[0m14:41:08.982832 [debug] [Thread-2 (]: Began compiling node test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6
[0m14:41:08.989816 [debug] [Thread-3 (]: Began compiling node test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a
[0m14:41:08.998043 [debug] [Thread-1 (]: Writing injected SQL for node "test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31"
[0m14:41:08.998043 [debug] [Thread-4 (]: Began compiling node test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc
[0m14:41:09.001042 [debug] [Thread-2 (]: Writing injected SQL for node "test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6"
[0m14:41:09.001042 [debug] [Thread-3 (]: Writing injected SQL for node "test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a"
[0m14:41:09.001042 [debug] [Thread-4 (]: Writing injected SQL for node "test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc"
[0m14:41:09.007703 [debug] [Thread-1 (]: Began executing node test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31
[0m14:41:09.018970 [debug] [Thread-1 (]: Writing runtime sql for node "test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31"
[0m14:41:09.019974 [debug] [Thread-3 (]: Began executing node test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a
[0m14:41:09.019974 [debug] [Thread-2 (]: Began executing node test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6
[0m14:41:09.019974 [debug] [Thread-4 (]: Began executing node test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc
[0m14:41:09.021973 [debug] [Thread-3 (]: Writing runtime sql for node "test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a"
[0m14:41:09.021973 [debug] [Thread-2 (]: Writing runtime sql for node "test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6"
[0m14:41:09.024821 [debug] [Thread-4 (]: Writing runtime sql for node "test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc"
[0m14:41:09.024821 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31"
[0m14:41:09.024821 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31: BEGIN
[0m14:41:09.024821 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:09.024821 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a"
[0m14:41:09.024821 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6"
[0m14:41:09.024821 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a: BEGIN
[0m14:41:09.024821 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.024821 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6: BEGIN
[0m14:41:09.024821 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:09.024821 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31"
[0m14:41:09.024821 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc"
[0m14:41:09.024821 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:41:09.024821 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "duck_poc"."main"."customers_d1"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.024821 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc: BEGIN
[0m14:41:09.024821 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:09.030143 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.030143 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:41:09.030646 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.030646 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a"
[0m14:41:09.030646 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6"
[0m14:41:09.030646 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "duck_poc"."main"."customers_d1"
where email is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.033840 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31: ROLLBACK
[0m14:41:09.033840 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:41:09.034839 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_name
from "duck_poc"."main"."customers_d1"
where customer_name is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.034839 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc"
[0m14:41:09.035839 [debug] [Thread-1 (]: Failed to rollback 'test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31'
[0m14:41:09.035839 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.035839 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "duck_poc"."main"."dim_customer"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.035839 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31: Close
[0m14:41:09.036840 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.037840 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a: ROLLBACK
[0m14:41:09.037840 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:41:09.038840 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6: ROLLBACK
[0m14:41:09.037840 [info ] [Thread-1 (]: 1 of 15 PASS not_null_customers_d1_customer_id ................................. [[32mPASS[0m in 0.06s]
[0m14:41:09.039840 [debug] [Thread-3 (]: Failed to rollback 'test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a'
[0m14:41:09.040840 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc: ROLLBACK
[0m14:41:09.041157 [debug] [Thread-1 (]: Finished running node test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31
[0m14:41:09.041157 [debug] [Thread-2 (]: Failed to rollback 'test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6'
[0m14:41:09.041157 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a: Close
[0m14:41:09.042158 [debug] [Thread-4 (]: Failed to rollback 'test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc'
[0m14:41:09.042158 [debug] [Thread-1 (]: Began running node test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce
[0m14:41:09.043158 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6: Close
[0m14:41:09.043158 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc: Close
[0m14:41:09.043158 [info ] [Thread-3 (]: 3 of 15 PASS not_null_customers_d1_email ....................................... [[32mPASS[0m in 0.06s]
[0m14:41:09.044158 [info ] [Thread-1 (]: 5 of 15 START test not_null_fct_sales_customer_id .............................. [RUN]
[0m14:41:09.044158 [info ] [Thread-2 (]: 2 of 15 PASS not_null_customers_d1_customer_name ............................... [[32mPASS[0m in 0.06s]
[0m14:41:09.045289 [debug] [Thread-3 (]: Finished running node test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a
[0m14:41:09.044158 [info ] [Thread-4 (]: 4 of 15 PASS not_null_dim_customer_customer_id ................................. [[32mPASS[0m in 0.06s]
[0m14:41:09.045289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_customers_d1_customer_id.f2773a6a31, now test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce)
[0m14:41:09.045289 [debug] [Thread-2 (]: Finished running node test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6
[0m14:41:09.046289 [debug] [Thread-3 (]: Began running node test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c
[0m14:41:09.046289 [debug] [Thread-4 (]: Finished running node test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc
[0m14:41:09.046289 [debug] [Thread-1 (]: Began compiling node test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce
[0m14:41:09.046289 [debug] [Thread-2 (]: Began running node test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a
[0m14:41:09.047289 [debug] [Thread-4 (]: Began running node test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3
[0m14:41:09.047289 [info ] [Thread-3 (]: 6 of 15 START test not_null_fct_sales_sales_id ................................. [RUN]
[0m14:41:09.050003 [debug] [Thread-1 (]: Writing injected SQL for node "test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce"
[0m14:41:09.050003 [info ] [Thread-2 (]: 7 of 15 START test not_null_sales_d1_customer_id ............................... [RUN]
[0m14:41:09.051495 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_customers_d1_email.2abd0f0f7a, now test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c)
[0m14:41:09.050897 [info ] [Thread-4 (]: 8 of 15 START test not_null_sales_d1_event_ts .................................. [RUN]
[0m14:41:09.051495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_customers_d1_customer_name.d414e6beb6, now test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a)
[0m14:41:09.051495 [debug] [Thread-3 (]: Began compiling node test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c
[0m14:41:09.052499 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_dim_customer_customer_id.9775012dfc, now test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3)
[0m14:41:09.052499 [debug] [Thread-2 (]: Began compiling node test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a
[0m14:41:09.054498 [debug] [Thread-3 (]: Writing injected SQL for node "test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c"
[0m14:41:09.055498 [debug] [Thread-1 (]: Began executing node test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce
[0m14:41:09.055498 [debug] [Thread-4 (]: Began compiling node test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3
[0m14:41:09.057685 [debug] [Thread-2 (]: Writing injected SQL for node "test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a"
[0m14:41:09.059729 [debug] [Thread-1 (]: Writing runtime sql for node "test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce"
[0m14:41:09.062031 [debug] [Thread-4 (]: Writing injected SQL for node "test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3"
[0m14:41:09.063028 [debug] [Thread-3 (]: Began executing node test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c
[0m14:41:09.064030 [debug] [Thread-3 (]: Writing runtime sql for node "test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c"
[0m14:41:09.065028 [debug] [Thread-2 (]: Began executing node test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a
[0m14:41:09.066024 [debug] [Thread-2 (]: Writing runtime sql for node "test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a"
[0m14:41:09.067044 [debug] [Thread-4 (]: Began executing node test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3
[0m14:41:09.067044 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce"
[0m14:41:09.068452 [debug] [Thread-4 (]: Writing runtime sql for node "test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3"
[0m14:41:09.069086 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce: BEGIN
[0m14:41:09.069086 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c"
[0m14:41:09.069086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:09.070091 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c: BEGIN
[0m14:41:09.070091 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a"
[0m14:41:09.070091 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.071090 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:41:09.071090 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3"
[0m14:41:09.071090 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a: BEGIN
[0m14:41:09.071090 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce"
[0m14:41:09.072089 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3: BEGIN
[0m14:41:09.072089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:09.072089 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "duck_poc"."main"."fct_sales"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.072089 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:09.073090 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:41:09.073090 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.073090 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c"
[0m14:41:09.073090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.074382 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a"
[0m14:41:09.074382 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_id
from "duck_poc"."main"."fct_sales"
where sales_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.074382 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:41:09.074382 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "duck_poc"."main"."sales_d1"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.076065 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce: ROLLBACK
[0m14:41:09.076065 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3"
[0m14:41:09.076065 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:41:09.076065 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from "duck_poc"."main"."sales_d1"
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.076065 [debug] [Thread-1 (]: Failed to rollback 'test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce'
[0m14:41:09.076065 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.076065 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c: ROLLBACK
[0m14:41:09.076065 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce: Close
[0m14:41:09.076065 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:41:09.076065 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a: ROLLBACK
[0m14:41:09.076065 [debug] [Thread-3 (]: Failed to rollback 'test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c'
[0m14:41:09.076065 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3: ROLLBACK
[0m14:41:09.076065 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fct_sales_customer_id .................................... [[32mPASS[0m in 0.03s]
[0m14:41:09.083070 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c: Close
[0m14:41:09.082714 [debug] [Thread-2 (]: Failed to rollback 'test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a'
[0m14:41:09.083070 [debug] [Thread-1 (]: Finished running node test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce
[0m14:41:09.083070 [debug] [Thread-4 (]: Failed to rollback 'test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3'
[0m14:41:09.083070 [debug] [Thread-2 (]: On test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a: Close
[0m14:41:09.083070 [info ] [Thread-3 (]: 6 of 15 PASS not_null_fct_sales_sales_id ....................................... [[32mPASS[0m in 0.03s]
[0m14:41:09.083070 [debug] [Thread-1 (]: Began running node test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2
[0m14:41:09.083070 [debug] [Thread-4 (]: On test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3: Close
[0m14:41:09.083070 [debug] [Thread-3 (]: Finished running node test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c
[0m14:41:09.083070 [info ] [Thread-2 (]: 7 of 15 PASS not_null_sales_d1_customer_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:41:09.083070 [info ] [Thread-1 (]: 9 of 15 START test not_null_sales_d1_sales_id .................................. [RUN]
[0m14:41:09.083070 [debug] [Thread-3 (]: Began running node test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e
[0m14:41:09.083070 [info ] [Thread-4 (]: 8 of 15 PASS not_null_sales_d1_event_ts ........................................ [[32mPASS[0m in 0.03s]
[0m14:41:09.087421 [debug] [Thread-2 (]: Finished running node test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a
[0m14:41:09.087421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_fct_sales_customer_id.998bfce0ce, now test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2)
[0m14:41:09.088425 [debug] [Thread-4 (]: Finished running node test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3
[0m14:41:09.087421 [info ] [Thread-3 (]: 10 of 15 START test not_null_sales_with_customer_sales_id ...................... [RUN]
[0m14:41:09.088425 [debug] [Thread-2 (]: Began running node test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392
[0m14:41:09.088425 [debug] [Thread-1 (]: Began compiling node test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2
[0m14:41:09.089425 [debug] [Thread-4 (]: Began running node test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b
[0m14:41:09.089425 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_fct_sales_sales_id.5d3241e11c, now test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e)
[0m14:41:09.092320 [debug] [Thread-1 (]: Writing injected SQL for node "test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2"
[0m14:41:09.089425 [info ] [Thread-2 (]: 11 of 15 START test relationships_fct_sales_customer_id__customer_id__ref_dim_customer_  [RUN]
[0m14:41:09.092720 [debug] [Thread-3 (]: Began compiling node test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e
[0m14:41:09.092720 [info ] [Thread-4 (]: 12 of 15 START test unique_customers_d1_customer_id ............................ [RUN]
[0m14:41:09.092720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_sales_d1_customer_id.b10374588a, now test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392)
[0m14:41:09.095787 [debug] [Thread-3 (]: Writing injected SQL for node "test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e"
[0m14:41:09.095787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_sales_d1_event_ts.f271e1dfe3, now test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b)
[0m14:41:09.095787 [debug] [Thread-2 (]: Began compiling node test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392
[0m14:41:09.096780 [debug] [Thread-4 (]: Began compiling node test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b
[0m14:41:09.096780 [debug] [Thread-1 (]: Began executing node test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2
[0m14:41:09.101765 [debug] [Thread-2 (]: Writing injected SQL for node "test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392"
[0m14:41:09.105764 [debug] [Thread-4 (]: Writing injected SQL for node "test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b"
[0m14:41:09.107754 [debug] [Thread-1 (]: Writing runtime sql for node "test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2"
[0m14:41:09.107754 [debug] [Thread-3 (]: Began executing node test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e
[0m14:41:09.109920 [debug] [Thread-3 (]: Writing runtime sql for node "test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e"
[0m14:41:09.109920 [debug] [Thread-2 (]: Began executing node test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392
[0m14:41:09.109920 [debug] [Thread-4 (]: Began executing node test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b
[0m14:41:09.111924 [debug] [Thread-2 (]: Writing runtime sql for node "test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392"
[0m14:41:09.113923 [debug] [Thread-4 (]: Writing runtime sql for node "test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b"
[0m14:41:09.113923 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2"
[0m14:41:09.114923 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e"
[0m14:41:09.114923 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2: BEGIN
[0m14:41:09.114923 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e: BEGIN
[0m14:41:09.116021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:09.116021 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:41:09.116021 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392"
[0m14:41:09.117026 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b"
[0m14:41:09.117026 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.117026 [debug] [Thread-2 (]: On test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392: BEGIN
[0m14:41:09.117026 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:09.117026 [debug] [Thread-4 (]: On test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b: BEGIN
[0m14:41:09.117026 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2"
[0m14:41:09.117026 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:09.117026 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e"
[0m14:41:09.117026 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:41:09.117026 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_id
from "duck_poc"."main"."sales_d1"
where sales_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.117026 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_id
from "duck_poc"."main"."sales_with_customer"
where sales_id is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.117026 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.117026 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.117026 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392"
[0m14:41:09.117026 [debug] [Thread-4 (]: Using duckdb connection "test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b"
[0m14:41:09.117026 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.117026 [debug] [Thread-2 (]: On test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "duck_poc"."main"."fct_sales"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "duck_poc"."main"."dim_customer"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:41:09.117026 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.117026 [debug] [Thread-4 (]: On test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "duck_poc"."main"."customers_d1"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:41:09.117026 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2: ROLLBACK
[0m14:41:09.124387 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e: ROLLBACK
[0m14:41:09.124925 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.124925 [debug] [Thread-1 (]: Failed to rollback 'test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2'
[0m14:41:09.124925 [debug] [Thread-3 (]: Failed to rollback 'test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e'
[0m14:41:09.124925 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:41:09.124925 [debug] [Thread-2 (]: On test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392: ROLLBACK
[0m14:41:09.124925 [debug] [Thread-1 (]: On test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2: Close
[0m14:41:09.124925 [debug] [Thread-3 (]: On test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e: Close
[0m14:41:09.124925 [debug] [Thread-4 (]: On test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b: ROLLBACK
[0m14:41:09.124925 [debug] [Thread-2 (]: Failed to rollback 'test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392'
[0m14:41:09.124925 [info ] [Thread-1 (]: 9 of 15 PASS not_null_sales_d1_sales_id ........................................ [[32mPASS[0m in 0.04s]
[0m14:41:09.124925 [debug] [Thread-2 (]: On test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392: Close
[0m14:41:09.124925 [info ] [Thread-3 (]: 10 of 15 PASS not_null_sales_with_customer_sales_id ............................ [[32mPASS[0m in 0.04s]
[0m14:41:09.124925 [debug] [Thread-4 (]: Failed to rollback 'test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b'
[0m14:41:09.124925 [debug] [Thread-1 (]: Finished running node test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2
[0m14:41:09.132702 [debug] [Thread-3 (]: Finished running node test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e
[0m14:41:09.124925 [info ] [Thread-2 (]: 11 of 15 PASS relationships_fct_sales_customer_id__customer_id__ref_dim_customer_  [[32mPASS[0m in 0.03s]
[0m14:41:09.132702 [debug] [Thread-4 (]: On test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b: Close
[0m14:41:09.132702 [debug] [Thread-1 (]: Began running node test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1
[0m14:41:09.132702 [debug] [Thread-3 (]: Began running node test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816
[0m14:41:09.133706 [debug] [Thread-2 (]: Finished running node test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392
[0m14:41:09.133706 [info ] [Thread-4 (]: 12 of 15 PASS unique_customers_d1_customer_id .................................. [[32mPASS[0m in 0.04s]
[0m14:41:09.133706 [info ] [Thread-1 (]: 13 of 15 START test unique_dim_customer_customer_id ............................ [RUN]
[0m14:41:09.134706 [debug] [Thread-2 (]: Began running node test.duckdb_poc.unique_sales_d1_sales_id.506a998370
[0m14:41:09.134706 [debug] [Thread-4 (]: Finished running node test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b
[0m14:41:09.134706 [info ] [Thread-3 (]: 14 of 15 START test unique_fct_sales_sales_id .................................. [RUN]
[0m14:41:09.135707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_sales_d1_sales_id.50a376e2e2, now test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1)
[0m14:41:09.135707 [info ] [Thread-2 (]: 15 of 15 START test unique_sales_d1_sales_id ................................... [RUN]
[0m14:41:09.135707 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.not_null_sales_with_customer_sales_id.94fbb1a23e, now test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816)
[0m14:41:09.136706 [debug] [Thread-1 (]: Began compiling node test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1
[0m14:41:09.136706 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_.f432b66392, now test.duckdb_poc.unique_sales_d1_sales_id.506a998370)
[0m14:41:09.136706 [debug] [Thread-3 (]: Began compiling node test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816
[0m14:41:09.168071 [debug] [Thread-1 (]: Writing injected SQL for node "test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1"
[0m14:41:09.168071 [debug] [Thread-2 (]: Began compiling node test.duckdb_poc.unique_sales_d1_sales_id.506a998370
[0m14:41:09.168071 [debug] [Thread-3 (]: Writing injected SQL for node "test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816"
[0m14:41:09.174371 [debug] [Thread-2 (]: Writing injected SQL for node "test.duckdb_poc.unique_sales_d1_sales_id.506a998370"
[0m14:41:09.174796 [debug] [Thread-3 (]: Began executing node test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816
[0m14:41:09.174796 [debug] [Thread-1 (]: Began executing node test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1
[0m14:41:09.174796 [debug] [Thread-3 (]: Writing runtime sql for node "test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816"
[0m14:41:09.174796 [debug] [Thread-1 (]: Writing runtime sql for node "test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1"
[0m14:41:09.174796 [debug] [Thread-2 (]: Began executing node test.duckdb_poc.unique_sales_d1_sales_id.506a998370
[0m14:41:09.174796 [debug] [Thread-2 (]: Writing runtime sql for node "test.duckdb_poc.unique_sales_d1_sales_id.506a998370"
[0m14:41:09.174796 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1"
[0m14:41:09.174796 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816"
[0m14:41:09.174796 [debug] [Thread-1 (]: On test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1: BEGIN
[0m14:41:09.174796 [debug] [Thread-3 (]: On test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816: BEGIN
[0m14:41:09.174796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:09.174796 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.unique_sales_d1_sales_id.506a998370"
[0m14:41:09.174796 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:41:09.182727 [debug] [Thread-2 (]: On test.duckdb_poc.unique_sales_d1_sales_id.506a998370: BEGIN
[0m14:41:09.182727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.182727 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:09.183732 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.183732 [debug] [Thread-1 (]: Using duckdb connection "test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1"
[0m14:41:09.183732 [debug] [Thread-3 (]: Using duckdb connection "test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816"
[0m14:41:09.183732 [debug] [Thread-1 (]: On test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "duck_poc"."main"."dim_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:41:09.184732 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.184732 [debug] [Thread-3 (]: On test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sales_id as unique_field,
    count(*) as n_records

from "duck_poc"."main"."fct_sales"
where sales_id is not null
group by sales_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:41:09.184732 [debug] [Thread-2 (]: Using duckdb connection "test.duckdb_poc.unique_sales_d1_sales_id.506a998370"
[0m14:41:09.185731 [debug] [Thread-2 (]: On test.duckdb_poc.unique_sales_d1_sales_id.506a998370: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "test.duckdb_poc.unique_sales_d1_sales_id.506a998370"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    sales_id as unique_field,
    count(*) as n_records

from "duck_poc"."main"."sales_d1"
where sales_id is not null
group by sales_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:41:09.185731 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.186732 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:09.186732 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:41:09.187732 [debug] [Thread-2 (]: On test.duckdb_poc.unique_sales_d1_sales_id.506a998370: ROLLBACK
[0m14:41:09.188732 [debug] [Thread-3 (]: On test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816: ROLLBACK
[0m14:41:09.188732 [debug] [Thread-1 (]: On test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1: ROLLBACK
[0m14:41:09.189731 [debug] [Thread-2 (]: Failed to rollback 'test.duckdb_poc.unique_sales_d1_sales_id.506a998370'
[0m14:41:09.190731 [debug] [Thread-3 (]: Failed to rollback 'test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816'
[0m14:41:09.191130 [debug] [Thread-1 (]: Failed to rollback 'test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1'
[0m14:41:09.191130 [debug] [Thread-2 (]: On test.duckdb_poc.unique_sales_d1_sales_id.506a998370: Close
[0m14:41:09.191130 [debug] [Thread-3 (]: On test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816: Close
[0m14:41:09.192154 [debug] [Thread-1 (]: On test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1: Close
[0m14:41:09.192154 [info ] [Thread-2 (]: 15 of 15 PASS unique_sales_d1_sales_id ......................................... [[32mPASS[0m in 0.06s]
[0m14:41:09.193155 [debug] [Thread-2 (]: Finished running node test.duckdb_poc.unique_sales_d1_sales_id.506a998370
[0m14:41:09.192154 [info ] [Thread-3 (]: 14 of 15 PASS unique_fct_sales_sales_id ........................................ [[32mPASS[0m in 0.06s]
[0m14:41:09.194155 [debug] [Thread-3 (]: Finished running node test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816
[0m14:41:09.193155 [info ] [Thread-1 (]: 13 of 15 PASS unique_dim_customer_customer_id .................................. [[32mPASS[0m in 0.06s]
[0m14:41:09.194155 [debug] [Thread-1 (]: Finished running node test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1
[0m14:41:09.195154 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:09.195154 [debug] [MainThread]: On master: BEGIN
[0m14:41:09.195154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:09.196153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:09.196153 [debug] [MainThread]: On master: COMMIT
[0m14:41:09.196153 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:09.196153 [debug] [MainThread]: On master: COMMIT
[0m14:41:09.197153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:09.197153 [debug] [MainThread]: On master: Close
[0m14:41:09.197153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:09.197153 [debug] [MainThread]: Connection 'list_duck_poc_main' was properly closed.
[0m14:41:09.197153 [debug] [MainThread]: Connection 'test.duckdb_poc.unique_dim_customer_customer_id.b42affccd1' was properly closed.
[0m14:41:09.198162 [debug] [MainThread]: Connection 'test.duckdb_poc.unique_sales_d1_sales_id.506a998370' was properly closed.
[0m14:41:09.198162 [debug] [MainThread]: Connection 'test.duckdb_poc.unique_fct_sales_sales_id.c2aee10816' was properly closed.
[0m14:41:09.198162 [debug] [MainThread]: Connection 'test.duckdb_poc.unique_customers_d1_customer_id.904aa1a50b' was properly closed.
[0m14:41:09.198162 [info ] [MainThread]: 
[0m14:41:09.198162 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m14:41:09.200168 [debug] [MainThread]: Command end result
[0m14:41:09.213609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\manifest.json
[0m14:41:09.213609 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\semantic_manifest.json
[0m14:41:09.220442 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\run_results.json
[0m14:41:09.220442 [info ] [MainThread]: 
[0m14:41:09.220442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:09.220442 [info ] [MainThread]: 
[0m14:41:09.221443 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m14:41:09.221443 [debug] [MainThread]: Command `dbt test` succeeded at 14:41:09.221443 after 0.95 seconds
[0m14:41:09.222442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D68A3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874D6891F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001874AF414F0>]}
[0m14:41:09.222442 [debug] [MainThread]: Flushing usage events
[0m14:41:09.381182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:13.350282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975B832AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019758B36DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975B220EC0>]}


============================== 14:41:13.350282 | 1c58ef70-efe5-47c1-b75a-65a269b9c067 ==============================
[0m14:41:13.350282 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:41:13.350282 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m14:41:13.368802 [info ] [MainThread]: dbt version: 1.10.10
[0m14:41:13.368802 [info ] [MainThread]: python version: 3.12.9
[0m14:41:13.369987 [info ] [MainThread]: python path: C:\Users\thesy\.conda\envs\TheAlamo\python.exe
[0m14:41:13.369987 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m14:41:13.433297 [info ] [MainThread]: Using profiles dir at C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project
[0m14:41:13.433297 [info ] [MainThread]: Using profiles.yml file at C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\profiles.yml
[0m14:41:13.433297 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\dbt_project.yml
[0m14:41:13.433297 [info ] [MainThread]: adapter type: duckdb
[0m14:41:13.433297 [info ] [MainThread]: adapter version: 1.9.4
[0m14:41:13.525986 [info ] [MainThread]: Configuration:
[0m14:41:13.525986 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:41:13.525986 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:41:13.525986 [info ] [MainThread]: Required dependencies:
[0m14:41:13.525986 [debug] [MainThread]: Executing "git --help"
[0m14:41:13.546919 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:41:13.547545 [debug] [MainThread]: STDERR: "b''"
[0m14:41:13.547934 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:41:13.547934 [info ] [MainThread]: Connection:
[0m14:41:13.547934 [info ] [MainThread]:   database: duck_poc
[0m14:41:13.548937 [info ] [MainThread]:   schema: main
[0m14:41:13.549306 [info ] [MainThread]:   path: duck_poc.duckdb
[0m14:41:13.549306 [info ] [MainThread]:   config_options: None
[0m14:41:13.550028 [info ] [MainThread]:   extensions: None
[0m14:41:13.550399 [info ] [MainThread]:   settings: {}
[0m14:41:13.550399 [info ] [MainThread]:   external_root: .
[0m14:41:13.550399 [info ] [MainThread]:   use_credential_provider: None
[0m14:41:13.551611 [info ] [MainThread]:   attach: None
[0m14:41:13.551611 [info ] [MainThread]:   filesystems: None
[0m14:41:13.551611 [info ] [MainThread]:   remote: None
[0m14:41:13.551611 [info ] [MainThread]:   plugins: None
[0m14:41:13.552578 [info ] [MainThread]:   disable_transactions: False
[0m14:41:13.552578 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:41:13.679449 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:41:13.711231 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:41:13.711231 [debug] [MainThread]: On debug: select 1 as id
[0m14:41:13.711231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:13.711231 [debug] [MainThread]: SQL status: OK in 0.010 seconds
[0m14:41:13.711231 [debug] [MainThread]: On debug: Close
[0m14:41:13.711231 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:41:13.711231 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:41:13.711231 [debug] [MainThread]: Command `dbt debug` succeeded at 14:41:13.711231 after 0.46 seconds
[0m14:41:13.711231 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:41:13.711231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975D13CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975BD05A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001975B8EB080>]}
[0m14:41:13.727311 [debug] [MainThread]: Flushing usage events
[0m14:41:13.843259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:17.329430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B796AAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B3F94C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B72ECD40>]}


============================== 14:41:17.329430 | cc140d1a-666c-4d6b-9ae6-57e17f6fe047 ==============================
[0m14:41:17.329430 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:41:17.329430 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m14:41:17.519632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B94DBB90>]}
[0m14:41:17.584772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B6EAD1F0>]}
[0m14:41:17.584772 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:41:17.715360 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m14:41:17.792276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:17.794279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:17.815550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B9615CD0>]}
[0m14:41:17.851080 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\manifest.json
[0m14:41:17.860869 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\semantic_manifest.json
[0m14:41:17.876796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B99E3590>]}
[0m14:41:17.876796 [info ] [MainThread]: Found 5 models, 15 data tests, 429 macros
[0m14:41:17.876796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B927E1B0>]}
[0m14:41:17.876796 [info ] [MainThread]: 
[0m14:41:17.876796 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:17.876796 [info ] [MainThread]: 
[0m14:41:17.876796 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:41:17.876796 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duck_poc'
[0m14:41:17.928440 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc"
[0m14:41:17.928440 [debug] [ThreadPool]: On list_duck_poc: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "list_duck_poc"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"duck_poc"'
    
  
  
[0m14:41:17.928440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:17.939070 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m14:41:17.940071 [debug] [ThreadPool]: On list_duck_poc: Close
[0m14:41:17.941071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_duck_poc, now create_duck_poc_main)
[0m14:41:17.941071 [debug] [ThreadPool]: Creating schema "database: "duck_poc"
schema: "main"
"
[0m14:41:17.941071 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:41:17.941071 [debug] [ThreadPool]: On create_duck_poc_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "create_duck_poc_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='duck_poc'
        and type='sqlite'
    
  
[0m14:41:17.941071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:17.941071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:17.941071 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:41:17.941071 [debug] [ThreadPool]: On create_duck_poc_main: BEGIN
[0m14:41:17.941071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:17.941071 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:41:17.941071 [debug] [ThreadPool]: On create_duck_poc_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "create_duck_poc_main"} */

    
    
        create schema if not exists "duck_poc"."main"
    
[0m14:41:17.941071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:17.941071 [debug] [ThreadPool]: On create_duck_poc_main: COMMIT
[0m14:41:17.941071 [debug] [ThreadPool]: Using duckdb connection "create_duck_poc_main"
[0m14:41:17.941071 [debug] [ThreadPool]: On create_duck_poc_main: COMMIT
[0m14:41:17.941071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:17.941071 [debug] [ThreadPool]: On create_duck_poc_main: Close
[0m14:41:17.941071 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_duck_poc_main'
[0m14:41:17.941071 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc_main"
[0m14:41:17.941071 [debug] [ThreadPool]: On list_duck_poc_main: BEGIN
[0m14:41:17.941071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:17.941071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:17.941071 [debug] [ThreadPool]: Using duckdb connection "list_duck_poc_main"
[0m14:41:17.941071 [debug] [ThreadPool]: On list_duck_poc_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "connection_name": "list_duck_poc_main"} */
select
      'duck_poc' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'duck_poc'
  
[0m14:41:17.956803 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:41:17.956803 [debug] [ThreadPool]: On list_duck_poc_main: ROLLBACK
[0m14:41:17.956803 [debug] [ThreadPool]: Failed to rollback 'list_duck_poc_main'
[0m14:41:17.956803 [debug] [ThreadPool]: On list_duck_poc_main: Close
[0m14:41:17.956803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B9387A40>]}
[0m14:41:17.956803 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:17.956803 [debug] [MainThread]: On master: BEGIN
[0m14:41:17.956803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:17.956803 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:17.956803 [debug] [MainThread]: On master: COMMIT
[0m14:41:17.956803 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:17.956803 [debug] [MainThread]: On master: COMMIT
[0m14:41:17.956803 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:17.966482 [debug] [MainThread]: On master: Close
[0m14:41:17.966482 [debug] [Thread-1 (]: Began running node model.duckdb_poc.customers_d1
[0m14:41:17.966482 [debug] [Thread-2 (]: Began running node model.duckdb_poc.sales_d1
[0m14:41:17.966482 [info ] [Thread-1 (]: 1 of 5 START sql table model main.customers_d1 ................................. [RUN]
[0m14:41:17.966482 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.duckdb_poc.customers_d1'
[0m14:41:17.966482 [info ] [Thread-2 (]: 2 of 5 START sql table model main.sales_d1 ..................................... [RUN]
[0m14:41:17.966482 [debug] [Thread-1 (]: Began compiling node model.duckdb_poc.customers_d1
[0m14:41:17.966482 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.duckdb_poc.sales_d1'
[0m14:41:17.972443 [debug] [Thread-2 (]: Began compiling node model.duckdb_poc.sales_d1
[0m14:41:17.972443 [debug] [Thread-1 (]: Writing injected SQL for node "model.duckdb_poc.customers_d1"
[0m14:41:17.972443 [debug] [Thread-2 (]: Writing injected SQL for node "model.duckdb_poc.sales_d1"
[0m14:41:17.972443 [debug] [Thread-2 (]: Began executing node model.duckdb_poc.sales_d1
[0m14:41:17.988124 [debug] [Thread-1 (]: Began executing node model.duckdb_poc.customers_d1
[0m14:41:17.994578 [debug] [Thread-2 (]: Writing runtime sql for node "model.duckdb_poc.sales_d1"
[0m14:41:18.000371 [debug] [Thread-1 (]: Writing runtime sql for node "model.duckdb_poc.customers_d1"
[0m14:41:18.001370 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:18.002372 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: BEGIN
[0m14:41:18.002372 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:18.002372 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:18.002372 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: BEGIN
[0m14:41:18.003371 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:41:18.003371 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:18.003371 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:18.004371 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:18.004371 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */

  
    
    

    create  table
      "duck_poc"."main"."customers_d1__dbt_tmp"
  
    as (
      
select
  customer_id,
  upper(trim(customer_name)) as customer_name,
  email,
  region_code,
  cast(load_hour as timestamp) as load_hour
from read_csv_auto('../data/customers_2025-08-31-10.csv', header=True)
    );
  
  
[0m14:41:18.004371 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:18.004371 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */

  
    
    

    create  table
      "duck_poc"."main"."sales_d1__dbt_tmp"
  
    as (
      
-- Treat CSVs under /data as your D0 snapshots
select
  cast(sales_id as integer) as sales_id,
  customer_id,
  cast(amount as double) as amount,
  currency_code,
  cast(event_ts as timestamp) as event_ts,
  cast(load_hour as timestamp) as load_hour
from read_csv_auto('../data/sales_2025-08-31-10.csv', header=True)
    );
  
  
[0m14:41:18.009270 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:41:18.011270 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:18.011270 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:41:18.011270 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */
alter table "duck_poc"."main"."customers_d1" rename to "customers_d1__dbt_backup"
[0m14:41:18.016011 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:18.016011 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */
alter table "duck_poc"."main"."sales_d1" rename to "sales_d1__dbt_backup"
[0m14:41:18.016011 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:41:18.016011 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:18.016011 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */
alter table "duck_poc"."main"."customers_d1__dbt_tmp" rename to "customers_d1"
[0m14:41:18.016011 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:41:18.016011 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:18.016011 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */
alter table "duck_poc"."main"."sales_d1__dbt_tmp" rename to "sales_d1"
[0m14:41:18.016011 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:41:18.031346 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m14:41:18.031346 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: COMMIT
[0m14:41:18.032751 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: COMMIT
[0m14:41:18.032751 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:18.032751 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:18.033846 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: COMMIT
[0m14:41:18.033846 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: COMMIT
[0m14:41:18.035846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:41:18.038852 [debug] [Thread-1 (]: Using duckdb connection "model.duckdb_poc.customers_d1"
[0m14:41:18.038852 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.customers_d1"} */

      drop table if exists "duck_poc"."main"."customers_d1__dbt_backup" cascade
    
[0m14:41:18.039845 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:41:18.040846 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_d1"
[0m14:41:18.040846 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_d1"} */

      drop table if exists "duck_poc"."main"."sales_d1__dbt_backup" cascade
    
[0m14:41:18.041846 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:41:18.041846 [debug] [Thread-1 (]: On model.duckdb_poc.customers_d1: Close
[0m14:41:18.041846 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:41:18.041846 [debug] [Thread-2 (]: On model.duckdb_poc.sales_d1: Close
[0m14:41:18.041846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B934C860>]}
[0m14:41:18.041846 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B934DD30>]}
[0m14:41:18.041846 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.customers_d1 ............................ [[32mOK[0m in 0.08s]
[0m14:41:18.041846 [debug] [Thread-1 (]: Finished running node model.duckdb_poc.customers_d1
[0m14:41:18.041846 [info ] [Thread-2 (]: 2 of 5 OK created sql table model main.sales_d1 ................................ [[32mOK[0m in 0.08s]
[0m14:41:18.041846 [debug] [Thread-2 (]: Finished running node model.duckdb_poc.sales_d1
[0m14:41:18.041846 [debug] [Thread-4 (]: Began running node model.duckdb_poc.dim_customer
[0m14:41:18.041846 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_customer ................................. [RUN]
[0m14:41:18.041846 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.duckdb_poc.dim_customer'
[0m14:41:18.041846 [debug] [Thread-3 (]: Began running node model.duckdb_poc.fct_sales
[0m14:41:18.041846 [debug] [Thread-4 (]: Began compiling node model.duckdb_poc.dim_customer
[0m14:41:18.041846 [debug] [Thread-4 (]: Writing injected SQL for node "model.duckdb_poc.dim_customer"
[0m14:41:18.041846 [info ] [Thread-3 (]: 4 of 5 START sql table model main.fct_sales .................................... [RUN]
[0m14:41:18.041846 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.duckdb_poc.fct_sales'
[0m14:41:18.041846 [debug] [Thread-3 (]: Began compiling node model.duckdb_poc.fct_sales
[0m14:41:18.041846 [debug] [Thread-3 (]: Writing injected SQL for node "model.duckdb_poc.fct_sales"
[0m14:41:18.041846 [debug] [Thread-4 (]: Began executing node model.duckdb_poc.dim_customer
[0m14:41:18.057571 [debug] [Thread-4 (]: Writing runtime sql for node "model.duckdb_poc.dim_customer"
[0m14:41:18.058308 [debug] [Thread-3 (]: Began executing node model.duckdb_poc.fct_sales
[0m14:41:18.060267 [debug] [Thread-3 (]: Writing runtime sql for node "model.duckdb_poc.fct_sales"
[0m14:41:18.060267 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:18.060267 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: BEGIN
[0m14:41:18.060267 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:41:18.061489 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:41:18.061489 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:18.061489 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:18.062489 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: BEGIN
[0m14:41:18.062489 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */

  
    
    

    create  table
      "duck_poc"."main"."dim_customer__dbt_tmp"
  
    as (
      
select
  customer_id,
  any_value(customer_name) as customer_name,
  any_value(email) as email,
  any_value(region_code) as region_code
from "duck_poc"."main"."customers_d1"
group by customer_id
    );
  
  
[0m14:41:18.062489 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:18.063489 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:18.063489 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:18.063489 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */

  
    
    

    create  table
      "duck_poc"."main"."fct_sales__dbt_tmp"
  
    as (
      
select
  sales_id,
  event_ts as sale_ts,
  amount,
  currency_code,
  customer_id
from "duck_poc"."main"."sales_d1"
    );
  
  
[0m14:41:18.063489 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:18.066810 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:18.067814 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:41:18.067814 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */
alter table "duck_poc"."main"."fct_sales" rename to "fct_sales__dbt_backup"
[0m14:41:18.069812 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:18.069812 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */
alter table "duck_poc"."main"."dim_customer" rename to "dim_customer__dbt_backup"
[0m14:41:18.069812 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m14:41:18.071815 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:18.071815 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */
alter table "duck_poc"."main"."fct_sales__dbt_tmp" rename to "fct_sales"
[0m14:41:18.071815 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:41:18.074366 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:18.074366 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */
alter table "duck_poc"."main"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m14:41:18.074366 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:18.076086 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: COMMIT
[0m14:41:18.076086 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:18.076086 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:41:18.076086 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: COMMIT
[0m14:41:18.076086 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: COMMIT
[0m14:41:18.076086 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:18.076086 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: COMMIT
[0m14:41:18.076086 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:41:18.076086 [debug] [Thread-3 (]: Using duckdb connection "model.duckdb_poc.fct_sales"
[0m14:41:18.076086 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.fct_sales"} */

      drop table if exists "duck_poc"."main"."fct_sales__dbt_backup" cascade
    
[0m14:41:18.076086 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:41:18.076086 [debug] [Thread-4 (]: Using duckdb connection "model.duckdb_poc.dim_customer"
[0m14:41:18.076086 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:41:18.082683 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.dim_customer"} */

      drop table if exists "duck_poc"."main"."dim_customer__dbt_backup" cascade
    
[0m14:41:18.083133 [debug] [Thread-3 (]: On model.duckdb_poc.fct_sales: Close
[0m14:41:18.083133 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B9E9CEC0>]}
[0m14:41:18.083133 [info ] [Thread-3 (]: 4 of 5 OK created sql table model main.fct_sales ............................... [[32mOK[0m in 0.04s]
[0m14:41:18.083133 [debug] [Thread-3 (]: Finished running node model.duckdb_poc.fct_sales
[0m14:41:18.083133 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:41:18.083133 [debug] [Thread-4 (]: On model.duckdb_poc.dim_customer: Close
[0m14:41:18.083133 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B9E0ECF0>]}
[0m14:41:18.083133 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_customer ............................ [[32mOK[0m in 0.04s]
[0m14:41:18.091028 [debug] [Thread-4 (]: Finished running node model.duckdb_poc.dim_customer
[0m14:41:18.091028 [debug] [Thread-2 (]: Began running node model.duckdb_poc.sales_with_customer
[0m14:41:18.091028 [info ] [Thread-2 (]: 5 of 5 START sql table model main.sales_with_customer .......................... [RUN]
[0m14:41:18.092100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.duckdb_poc.sales_d1, now model.duckdb_poc.sales_with_customer)
[0m14:41:18.092100 [debug] [Thread-2 (]: Began compiling node model.duckdb_poc.sales_with_customer
[0m14:41:18.093868 [debug] [Thread-2 (]: Writing injected SQL for node "model.duckdb_poc.sales_with_customer"
[0m14:41:18.094870 [debug] [Thread-2 (]: Began executing node model.duckdb_poc.sales_with_customer
[0m14:41:18.096878 [debug] [Thread-2 (]: Writing runtime sql for node "model.duckdb_poc.sales_with_customer"
[0m14:41:18.096878 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:18.097871 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: BEGIN
[0m14:41:18.097871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:18.097871 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:41:18.097871 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:18.097871 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */

  
    
    

    create  table
      "duck_poc"."main"."sales_with_customer__dbt_tmp"
  
    as (
      
select
  f.sales_id,
  f.sale_ts,
  f.amount,
  f.currency_code,
  c.customer_id,
  c.customer_name,
  c.email,
  c.region_code
from "duck_poc"."main"."fct_sales" f
join "duck_poc"."main"."dim_customer" c
  on c.customer_id = f.customer_id
    );
  
  
[0m14:41:18.100144 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:18.102148 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:18.102148 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */
alter table "duck_poc"."main"."sales_with_customer" rename to "sales_with_customer__dbt_backup"
[0m14:41:18.102148 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:41:18.104154 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:18.104154 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */
alter table "duck_poc"."main"."sales_with_customer__dbt_tmp" rename to "sales_with_customer"
[0m14:41:18.105154 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m14:41:18.105154 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: COMMIT
[0m14:41:18.105154 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:18.105154 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: COMMIT
[0m14:41:18.107701 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:18.134846 [debug] [Thread-2 (]: Using duckdb connection "model.duckdb_poc.sales_with_customer"
[0m14:41:18.134846 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "duckdb_poc", "target_name": "dev", "node_id": "model.duckdb_poc.sales_with_customer"} */

      drop table if exists "duck_poc"."main"."sales_with_customer__dbt_backup" cascade
    
[0m14:41:18.136332 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:41:18.137338 [debug] [Thread-2 (]: On model.duckdb_poc.sales_with_customer: Close
[0m14:41:18.137338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc140d1a-666c-4d6b-9ae6-57e17f6fe047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B9372960>]}
[0m14:41:18.137338 [info ] [Thread-2 (]: 5 of 5 OK created sql table model main.sales_with_customer ..................... [[32mOK[0m in 0.05s]
[0m14:41:18.138252 [debug] [Thread-2 (]: Finished running node model.duckdb_poc.sales_with_customer
[0m14:41:18.139259 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:18.139259 [debug] [MainThread]: On master: BEGIN
[0m14:41:18.139259 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:18.139259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:18.140257 [debug] [MainThread]: On master: COMMIT
[0m14:41:18.140257 [debug] [MainThread]: Using duckdb connection "master"
[0m14:41:18.140257 [debug] [MainThread]: On master: COMMIT
[0m14:41:18.140257 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:41:18.141258 [debug] [MainThread]: On master: Close
[0m14:41:18.141258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:18.141258 [debug] [MainThread]: Connection 'create_duck_poc_main' was properly closed.
[0m14:41:18.141788 [debug] [MainThread]: Connection 'list_duck_poc_main' was properly closed.
[0m14:41:18.141788 [debug] [MainThread]: Connection 'model.duckdb_poc.customers_d1' was properly closed.
[0m14:41:18.141788 [debug] [MainThread]: Connection 'model.duckdb_poc.sales_with_customer' was properly closed.
[0m14:41:18.141788 [debug] [MainThread]: Connection 'model.duckdb_poc.dim_customer' was properly closed.
[0m14:41:18.141788 [debug] [MainThread]: Connection 'model.duckdb_poc.fct_sales' was properly closed.
[0m14:41:18.141788 [info ] [MainThread]: 
[0m14:41:18.142792 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:41:18.142792 [debug] [MainThread]: Command end result
[0m14:41:18.142792 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\manifest.json
[0m14:41:18.142792 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\semantic_manifest.json
[0m14:41:18.161071 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\run_results.json
[0m14:41:18.161071 [info ] [MainThread]: 
[0m14:41:18.161071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:18.162088 [info ] [MainThread]: 
[0m14:41:18.162088 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m14:41:18.163088 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:18.162088 after 0.90 seconds
[0m14:41:18.163088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B35B6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B796AAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4B7383BC0>]}
[0m14:41:18.163088 [debug] [MainThread]: Flushing usage events
[0m14:41:18.298472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:46:41.827377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A7FF8EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A051BB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A0629E600>]}


============================== 14:46:41.831377 | c7864d0b-0599-4278-a2ef-8498b66113ef ==============================
[0m14:46:41.831377 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:46:41.831377 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt ls', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\thesy\\Desktop\\duckdb_dbt_poc\\duckdb_dbt_poc\\dbt_project\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:46:42.035410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7864d0b-0599-4278-a2ef-8498b66113ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A06635DC0>]}
[0m14:46:42.073498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7864d0b-0599-4278-a2ef-8498b66113ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A06375AF0>]}
[0m14:46:42.090180 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m14:46:42.219573 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m14:46:42.292369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:46:42.292369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:46:42.308198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7864d0b-0599-4278-a2ef-8498b66113ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A0659B7D0>]}
[0m14:46:42.356347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\manifest.json
[0m14:46:42.356347 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\thesy\Desktop\duckdb_dbt_poc\duckdb_dbt_poc\dbt_project\target\semantic_manifest.json
[0m14:46:42.378542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7864d0b-0599-4278-a2ef-8498b66113ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A0691E6F0>]}
[0m14:46:42.379562 [info ] [MainThread]: Found 5 models, 15 data tests, 429 macros
[0m14:46:42.380060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7864d0b-0599-4278-a2ef-8498b66113ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A0636E9C0>]}
[0m14:46:42.380060 [info ] [MainThread]: duckdb_poc.d1_clean.customers_d1
[0m14:46:42.381068 [info ] [MainThread]: duckdb_poc.d2_transform.dim_customer
[0m14:46:42.381068 [info ] [MainThread]: duckdb_poc.d2_transform.fct_sales
[0m14:46:42.381068 [info ] [MainThread]: duckdb_poc.d1_clean.sales_d1
[0m14:46:42.382067 [info ] [MainThread]: duckdb_poc.d3_present.sales_with_customer
[0m14:46:42.382067 [info ] [MainThread]: duckdb_poc.not_null_customers_d1_customer_id
[0m14:46:42.382067 [info ] [MainThread]: duckdb_poc.not_null_customers_d1_customer_name
[0m14:46:42.383067 [info ] [MainThread]: duckdb_poc.not_null_customers_d1_email
[0m14:46:42.383067 [info ] [MainThread]: duckdb_poc.not_null_dim_customer_customer_id
[0m14:46:42.383067 [info ] [MainThread]: duckdb_poc.not_null_fct_sales_customer_id
[0m14:46:42.383067 [info ] [MainThread]: duckdb_poc.not_null_fct_sales_sales_id
[0m14:46:42.383067 [info ] [MainThread]: duckdb_poc.not_null_sales_d1_customer_id
[0m14:46:42.384067 [info ] [MainThread]: duckdb_poc.not_null_sales_d1_event_ts
[0m14:46:42.384067 [info ] [MainThread]: duckdb_poc.not_null_sales_d1_sales_id
[0m14:46:42.384067 [info ] [MainThread]: duckdb_poc.not_null_sales_with_customer_sales_id
[0m14:46:42.385068 [info ] [MainThread]: duckdb_poc.relationships_fct_sales_customer_id__customer_id__ref_dim_customer_
[0m14:46:42.385068 [info ] [MainThread]: duckdb_poc.unique_customers_d1_customer_id
[0m14:46:42.385068 [info ] [MainThread]: duckdb_poc.unique_dim_customer_customer_id
[0m14:46:42.386068 [info ] [MainThread]: duckdb_poc.unique_fct_sales_sales_id
[0m14:46:42.386068 [info ] [MainThread]: duckdb_poc.unique_sales_d1_sales_id
[0m14:46:42.387068 [debug] [MainThread]: Command `dbt ls` succeeded at 14:46:42.387068 after 0.65 seconds
[0m14:46:42.387068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A05144770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A0629E600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A0629C440>]}
[0m14:46:42.388068 [debug] [MainThread]: Flushing usage events
[0m14:46:42.539666 [debug] [MainThread]: An error was encountered while trying to flush usage events
